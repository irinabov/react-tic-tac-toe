!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):"object"==typeof exports?exports.TicTacToe=e(require("react")):t.TicTacToe=e(t.react)}(this,function(t){return function(t){function e(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),c=function(t,e,r){for(var n=!0;n;){var i=t,o=e,s=r;n=!1,null===i&&(i=Function.prototype);var a=Object.getOwnPropertyDescriptor(i,o);if(void 0!==a){if("value"in a)return a.value;var c=a.get;if(void 0===c)return;return c.call(s)}var u=Object.getPrototypeOf(i);if(null===u)return;t=u,e=o,r=s,n=!0,a=u=void 0}},u=r(41),h=n(u),p=r(12),l=n(p),f=r(17),d=n(f),_=function(t){function e(t){var n=this;i(this,e),c(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t),this.board=new l.default(t.width),this.state={player:1,freezeBoard:!1,winner:!1},this.client=r(28),this.server=prompt("Please enter server info","ws://rhm-x3550-09.rhm.lab.eng.bos.redhat.com:8888"),this.ws=this.client.websocket_connect(WebSocket),this.connection=this.client.connect({connection_details:this.ws(this.server,["binary","AMQPWSB10","amqp"]),reconnect:!1}),this.receiver=this.connection.open_receiver("examples"),this.sender=this.connection.open_sender("examples"),this.client.on("message",function(t){var e=s(t.message.body,2),r=e[0],i=e[1];n.aiMoveBoard(r,i)})}return o(e,t),a(e,[{key:"nextPlayer",value:function(){return 1===this.state.player?2:1}},{key:"move",value:function(t,e,r,n){this.board.move(t,e,r);var i=this.board.checkWin();i?this.setState({winner:i,freezeBoard:!0}):n()}},{key:"playerMove",value:function(t){var e=this,r=t.target.dataset.cell.split("_"),n=s(r,2),i=n[0],o=n[1],a=0===this.board.getCell(i,o);a&&this.move(i,o,this.state.player,function(){e.props.singlePlayer?e.setState({player:e.nextPlayer(),freezeBoard:!0},e.aiMove):e.setState({player:e.nextPlayer()})})}},{key:"aiMove",value:function(){var t=d.default.move(this.board,this.state.player),e=s(t,2),r=e[0],n=e[1],i=[r,n];this.sender.send({body:i})}},{key:"aiMoveBoard",value:function(t,e){var r=this;setTimeout(function(){r.move(t,e,r.state.player,function(){r.setState({player:r.nextPlayer(),freezeBoard:!1})})},200)}},{key:"aiInit",value:function(){if(this.props.singlePlayer){var t=Math.floor(2*Math.random())+1;1===t&&this.aiMove()}}},{key:"reset",value:function(){this.board=new l.default(this.props.width),this.setState({player:1,freezeBoard:!1,winner:!1}),this.aiInit()}},{key:"componentDidMount",value:function(){this.aiInit()}},{key:"render",value:function(){var t=this,e=this.board.board,r=void 0;if(this.state.winner){var n=this.state.winner>2?"It's a tie!":"Player "+this.state.winner+" wins!";r=h.default.createElement("div",{className:"announcement"},h.default.createElement("p",null,n),h.default.createElement("button",{onClick:this.reset.bind(this)},"Reset"))}var i=e.map(function(e,r){var n=e.map(function(e,n){var i=e>0?1===e?"cell-p1":"cell-p2":"cell",o=r+"_"+n,s=void 0;return t.state.freezeBoard||(s=t.playerMove.bind(t)),h.default.createElement("div",{className:i,key:n,onClick:s,"data-cell":o})});return h.default.createElement("div",{className:"row",key:r},n)});return h.default.createElement("div",{className:"grid"},i,r)}}]),e}(h.default.Component);_.propTypes={width:h.default.PropTypes.number},_.defaultProps={width:3},e.default=_,t.exports=e.default},function(t,e,r){(function(t){/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
"use strict";function n(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function i(){return s.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(i()<e)throw new RangeError("Invalid typed array length");return s.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=s.prototype):(null===t&&(t=new s(e)),t.length=e),t}function s(t,e,r){if(!(s.TYPED_ARRAY_SUPPORT||this instanceof s))return new s(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return a(this,t,e,r)}function a(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?f(t,e,r,n):"string"==typeof e?p(t,e,r):d(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e,r,n){return c(e),e<=0?o(t,e):void 0!==r?"string"==typeof n?o(t,e).fill(r,n):o(t,e).fill(r):o(t,e)}function h(t,e){if(c(e),t=o(t,e<0?0:0|_(e)),!s.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function p(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!s.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|y(e,r);t=o(t,n);var i=t.write(e,r);return i!==n&&(t=t.slice(0,i)),t}function l(t,e){var r=e.length<0?0:0|_(e.length);t=o(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function f(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),s.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=s.prototype):t=l(t,e),t}function d(t,e){if(s.isBuffer(e)){var r=0|_(e.length);return t=o(t,r),0===t.length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||G(e.length)?o(t,0):l(t,e);if("Buffer"===e.type&&K(e.data))return l(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function m(t){return+t!=t&&(t=0),s.alloc(+t)}function y(t,e){if(s.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return J(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(t).length;default:if(n)return J(t).length;e=(""+e).toLowerCase(),n=!0}}function v(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,r);case"utf8":case"utf-8":return T(this,e,r);case"ascii":return R(this,e,r);case"latin1":case"binary":return I(this,e,r);case"base64":return P(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:b(t,e,r,n,i);if("number"==typeof e)return e&=255,s.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):b(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,r,n,i){function o(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}var s=1,a=t.length,c=e.length;if(void 0!==n&&(n=String(n).toLowerCase(),"ucs2"===n||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}var u;if(i){var h=-1;for(u=r;u<a;u++)if(o(t,u)===o(e,h===-1?0:u-h)){if(h===-1&&(h=u),u-h+1===c)return h*s}else h!==-1&&(u-=u-h),h=-1}else for(r+c>a&&(r=a-c),u=r;u>=0;u--){for(var p=!0,l=0;l<c;l++)if(o(t,u+l)!==o(e,l)){p=!1;break}if(p)return u}return-1}function E(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function x(t,e,r,n){return V(J(e,t.length-r),t,r,n)}function A(t,e,r,n){return V(Q(e),t,r,n)}function S(t,e,r,n){return A(t,e,r,n)}function k(t,e,r,n){return V(H(e),t,r,n)}function O(t,e,r,n){return V($(e,t.length-r),t,r,n)}function P(t,e,r){return 0===e&&r===t.length?X.fromByteArray(t):X.fromByteArray(t.slice(e,r))}function T(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var c,u,h,p;switch(a){case 1:o<128&&(s=o);break;case 2:c=t[i+1],128===(192&c)&&(p=(31&o)<<6|63&c,p>127&&(s=p));break;case 3:c=t[i+1],u=t[i+2],128===(192&c)&&128===(192&u)&&(p=(15&o)<<12|(63&c)<<6|63&u,p>2047&&(p<55296||p>57343)&&(s=p));break;case 4:c=t[i+1],u=t[i+2],h=t[i+3],128===(192&c)&&128===(192&u)&&128===(192&h)&&(p=(15&o)<<18|(63&c)<<12|(63&u)<<6|63&h,p>65535&&p<1114112&&(s=p))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return U(n)}function U(t){var e=t.length;if(e<=tt)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=tt));return r}function R(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function I(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function j(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=W(t[o]);return i}function N(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function B(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function L(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function C(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Y(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function q(t,e,r,n,i){return i||Y(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(t,e,r,n,23,4),r+4}function z(t,e,r,n,i){return i||Y(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(t,e,r,n,52,8),r+8}function D(t){if(t=F(t).replace(et,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function F(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function W(t){return t<16?"0"+t.toString(16):t.toString(16)}function J(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Q(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function $(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function H(t){return X.toByteArray(D(t))}function V(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function G(t){return t!==t}var X=r(18),Z=r(21),K=r(22);e.Buffer=s,e.SlowBuffer=m,e.INSPECT_MAX_BYTES=50,s.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:n(),e.kMaxLength=i(),s.poolSize=8192,s._augment=function(t){return t.__proto__=s.prototype,t},s.from=function(t,e,r){return a(null,t,e,r)},s.TYPED_ARRAY_SUPPORT&&(s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0})),s.alloc=function(t,e,r){return u(null,t,e,r)},s.allocUnsafe=function(t){return h(null,t)},s.allocUnsafeSlow=function(t){return h(null,t)},s.isBuffer=function(t){return!(null==t||!t._isBuffer)},s.compare=function(t,e){if(!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!K(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=s.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},s.byteLength=y,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):v.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},s.prototype.compare=function(t,e,r,n,i){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,i>>>=0,this===t)return 0;for(var o=i-n,a=r-e,c=Math.min(o,a),u=this.slice(n,i),h=t.slice(e,r),p=0;p<c;++p)if(u[p]!==h[p]){o=u[p],a=h[p];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return this.indexOf(t,e,r)!==-1},s.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,t,e,r);case"utf8":case"utf-8":return x(this,t,e,r);case"ascii":return A(this,t,e,r);case"latin1":case"binary":return S(this,t,e,r);case"base64":return k(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var tt=4096;s.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var n;if(s.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=s.prototype;else{var i=e-t;n=new s(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},s.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||B(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||B(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUInt8=function(t,e){return e||B(t,1,this.length),this[t]},s.prototype.readUInt16LE=function(t,e){return e||B(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUInt16BE=function(t,e){return e||B(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUInt32LE=function(t,e){return e||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUInt32BE=function(t,e){return e||B(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||B(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||B(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return e||B(t,1,this.length),128&this[t]?(255-this[t]+1)*-1:this[t]},s.prototype.readInt16LE=function(t,e){e||B(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){e||B(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return e||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return e||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return e||B(t,4,this.length),Z.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return e||B(t,4,this.length),Z.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return e||B(t,8,this.length),Z.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return e||B(t,8,this.length),Z.read(this,t,!1,52,8)},s.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;M(this,t,e,r,i,0)}var o=1,s=0;for(this[e]=255&t;++s<r&&(o*=256);)this[e+s]=t/o&255;return e+r},s.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var i=Math.pow(2,8*r)-1;M(this,t,e,r,i,0)}var o=r-1,s=1;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=t/s&255;return e+r},s.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,1,255,0),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,2,65535,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):C(this,t,e,!0),e+4},s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,4,4294967295,0),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);M(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);M(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,1,127,-128),s.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,2,32767,-32768),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,4,2147483647,-2147483648),s.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):C(this,t,e,!0),e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),s.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):C(this,t,e,!1),e+4},s.prototype.writeFloatLE=function(t,e,r){return q(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return q(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return z(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return z(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!s.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0);var o;if("number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=s.isBuffer(t)?t:J(new s(t,n).toString()),c=a.length;for(o=0;o<r-e;++o)this[o+e]=a[o%c]}return this};var et=/[^+\/0-9A-Za-z-_]/g}).call(e,function(){return this}())},function(t,e,r){"use strict";function n(t){Error.call(this),this.message=t,this.name="ProtocolError"}function i(t){n.call(this,t),this.message=t,this.name="TypeError"}function o(t,e,r){Error.call(this,t),this.message=t,this.name="ConnectionError",this.condition=e,this.description=t,this.connection=r}var s=r(16);s.inherits(n,Error),s.inherits(i,n),s.inherits(o,Error),t.exports={ProtocolError:n,TypeError:i,ConnectionError:o}},function(t,e,r){"use strict";var n=r(19);t.exports={frames:n("rhea:frames"),raw:n("rhea:raw"),reconnect:n("rhea:reconnect"),events:n("rhea:events"),message:n("rhea:message"),flow:n("rhea:flow"),io:n("rhea:io")}},function(t,e,r){(function(e){"use strict";function n(t,e,r,n){this.type=t,this.value=e,r&&(this.array_constructor={typecode:r},n&&(this.array_constructor.descriptor=n))}function i(t,e,r,i){this.name=t,this.typecode=e;var o=e>>>4;switch(o){case 4:this.width=0,this.category=T;break;case 5:this.width=1,this.category=T;break;case 6:this.width=2,this.category=T;break;case 7:this.width=4,this.category=T;break;case 8:this.width=8,this.category=T;break;case 9:this.width=16,this.category=T;break;case 10:this.width=1,this.category=U;break;case 11:this.width=4,this.category=U;break;case 12:this.width=1,this.category=R;break;case 13:this.width=4,this.category=R;break;case 14:this.width=1,this.category=I;break;case 15:this.width=4,this.category=I}r&&(r.read&&(this.read=r.read),r.write&&(this.write=r.write),r.encoding&&(this.encoding=r.encoding));var s=this;4===o?this.create=function(){return new n(s,i)}:14===o||15===o?this.create=function(t,e,r){return new n(s,t,e,r)}:this.create=function(t){return new n(s,t)}}function o(t){return Number(t).toString(16)}function s(t,e,r,n){var o=new i(t,e,r,n);o.create.typecode=o.typecode,j.by_code[o.typecode]=o,j[t]=o.create}function a(){return{read:function(t,e){return t.readUInt8(e)},write:function(t,e,r){t.writeUInt8(e,r)}}}function c(){return{read:function(t,e){return t.readUInt16BE(e)},write:function(t,e,r){t.writeUInt16BE(e,r)}}}function u(){return{read:function(t,e){return t.readUInt32BE(e)},write:function(t,e,r){t.writeUInt32BE(e,r)}}}function h(){return{read:function(t,e){return t.readInt8(e)},write:function(t,e,r){t.writeInt8(e,r)}}}function p(){return{read:function(t,e){return t.readInt16BE(e)},write:function(t,e,r){t.writeInt16BE(e,r)}}}function l(){return{read:function(t,e){return t.readInt32BE(e)},write:function(t,e,r){t.writeInt32BE(e,r)}}}function f(){return{read:function(t,e){return t.readFloatBE(e)},write:function(t,e,r){t.writeFloatBE(e,r)}}}function d(){return{read:function(t,e){return t.readDoubleBE(e)},write:function(t,e,r){t.writeDoubleBE(e,r)}}}function _(t,e,r){if("number"==typeof e||e instanceof Number){var n=Math.floor(e/N),i=e%N;t.writeUInt32BE(n,r),t.writeUInt32BE(i,r+4)}else e.copy(t,r)}function m(t,e){var r=t.readUInt32BE(e),n=t.readUInt32BE(e+4);return r<2097153?r*N+n:t.slice(e,e+8)}function y(t,e,r){if("number"==typeof e||e instanceof Number){var n=Math.abs(e),i=Math.floor(n/N),o=n%N;if(t.writeInt32BE(i,r),t.writeUInt32BE(o,r+4),e<0)for(var s=1,a=0;a<8;a++){var c=r+(7-a),u=(255^t[c])+s;t[c]=255&u,s=u>>8}}else e.copy(t,r)}function v(t,e){var r=t.readInt32BE(e),n=t.readUInt32BE(e+4);return r<2097153&&r>-2097153?r*N+n:t.slice(e,e+8)}function g(t,e){for(var r=0;r<e.length;r++)if(t.type.typecode===e[r].typecode)return!0;return!1}function w(t,e,r){for(var n=0;n<e&&n<t.length;n++)if(t[n]!==(r?255:0))return!1;return!0}function b(t){for(var e={},r=0;r+1<t.length;)e[t[r++]]=t[r++];return e}function E(t){var e=j.by_code[t];if(!e)throw new P.TypeError("Unrecognised typecode: "+o(t));return e}function x(t,e){return t>e?t:e}function A(t){if("symbol"===t)return{typecode:j.Sym8.typecode};throw new P.TypeError("TODO: Array of type "+t+" not yet supported")}function S(t,e){if(void 0!==e&&null!==e){if(Array.isArray(e)){if(!t.multiple)throw new P.TypeError("Field "+t.name+" does not support multiple values, got "+JSON.stringify(e));var r=A(t.type);return j.wrap_array(e,r.typecode,r.descriptor)}if("*"===t.type)return e;var n=j["wrap_"+t.type];if(n)return n(e);throw new P.TypeError("No wrapper for field "+t.name+" of type "+t.type)}if(t.mandatory)throw new P.TypeError("Field "+t.name+" is mandatory");return j.Null()}function k(t,e){var r;r="*"===e.type?function(){return this.value[t]}:function(){return j.unwrap(this.value[t])};var n=function(r){this.value[t]=S(e,r)};return{get:r,set:n,enumerable:!0,configurable:!1}}function O(t){var e=j.define_composite(t);j["wrap_"+t.name]=function(t){return e.create(t).described()},M[Number(e.descriptor.numeric).toString(10)]=e,M[e.descriptor.symbolic]=e}var P=r(2),T=1,U=2,R=3,I=4;n.prototype.toString=function(){return this.value?this.value.toString():null},n.prototype.toLocaleString=function(){return this.value?this.value.toLocaleString():null},n.prototype.valueOf=function(){return this.value},n.prototype.toJSON=function(){return this.value&&this.value.toJSON?this.value.toJSON():this.value},i.prototype.toString=function(){return this.name+"#"+o(this.typecode)};var j={by_code:{}};Object.defineProperty(j,"MAX_UINT",{value:4294967295,writable:!1,configurable:!1}),Object.defineProperty(j,"MAX_USHORT",{value:65535,writable:!1,configurable:!1});var N=4294967296,B=-2147483647;s("Null",64,void 0,null),s("Boolean",86,a()),s("True",65,void 0,!0),s("False",66,void 0,!1),s("Ubyte",80,a()),s("Ushort",96,c()),s("Uint",112,u()),s("SmallUint",82,a()),s("Uint0",67,void 0,0),s("Ulong",128,{write:_,read:m}),s("SmallUlong",83,a()),s("Ulong0",68,void 0,0),s("Byte",81,h()),s("Short",97,p()),s("Int",113,l()),s("SmallInt",84,h()),s("Long",129,{write:y,read:v}),s("SmallLong",85,h()),s("Float",114,f()),s("Double",130,d()),s("Decimal32",116),s("Decimal64",132),s("Decimal128",148),s("CharUTF32",115,u()),s("Timestamp",131,{write:y,read:v}),s("Uuid",152),s("Vbin8",160),s("Vbin32",176),s("Str8",161,{encoding:"utf8"}),s("Str32",177,{encoding:"utf8"}),s("Sym8",163,{encoding:"ascii"}),s("Sym32",179,{encoding:"ascii"}),s("List0",69,void 0,[]),s("List8",192),s("List32",208),s("Map8",193),s("Map32",209),s("Array8",224),s("Array32",240),j.is_ulong=function(t){return g(t,[j.Ulong,j.Ulong0,j.SmallUlong])},j.is_string=function(t){return g(t,[j.Str8,j.Str32])},j.is_symbol=function(t){return g(t,[j.Sym8,j.Sym32])},j.is_list=function(t){return g(t,[j.List0,j.List8,j.List32])},j.is_map=function(t){return g(t,[j.Map8,j.Map32])},j.wrap_boolean=function(t){return t?j.True():j.False()},j.wrap_ulong=function(t){return e.isBuffer(t)?w(t,8,!1)?j.Ulong0():w(t,7,!1)?j.SmallUlong(t[7]):j.Ulong(t):0===t?j.Ulong0():t>255?j.Ulong(t):j.SmallUlong(t)},j.wrap_uint=function(t){return 0===t?j.Uint0():t>255?j.Uint(t):j.SmallUint(t)},j.wrap_ushort=function(t){return j.Ushort(t)},j.wrap_ubyte=function(t){return j.Ubyte(t)},j.wrap_long=function(t){if(e.isBuffer(t)){var r=0!==(128&t[0]);return w(t,7,r)&&(128&t[7])===(r?128:0)?j.SmallLong(r?-((255^t[7])+1):t[7]):j.Long(t)}return t>127||t<-128?j.Long(t):j.SmallLong(t)},j.wrap_int=function(t){return t>127||t<-128?j.Int(t):j.SmallInt(t)},j.wrap_short=function(t){return j.Short(t)},j.wrap_byte=function(t){return j.Byte(t)},j.wrap_float=function(t){return j.Float(t)},j.wrap_double=function(t){return j.Double(t)},j.wrap_timestamp=function(t){return j.Timestamp(t)},j.wrap_char=function(t){return j.CharUTF32(t)},j.wrap_uuid=function(t){return j.Uuid(t)},j.wrap_binary=function(t){return t.length>255?j.Vbin32(t):j.Vbin8(t)},j.wrap_string=function(t){return t.length>255?j.Str32(t):j.Str8(t)},j.wrap_symbol=function(t){return t.length>255?j.Sym32(t):j.Sym8(t)},j.wrap_list=function(t){if(0===t.length)return j.List0();var e=t.map(j.wrap);return j.List32(e)},j.wrap_map=function(t,e){var r=[];for(var n in t)r.push(e?e(n):j.wrap(n)),r.push(j.wrap(t[n]));return j.Map32(r)},j.wrap_symbolic_map=function(t){return j.wrap_map(t,j.wrap_symbol)},j.wrap_array=function(t,e,r){if(e)return j.Array32(t,e,r);throw console.trace("An array must specify a type for its elements"),new P.TypeError("An array must specify a type for its elements")},j.wrap=function(t){var r=typeof t;if("string"===r)return j.wrap_string(t);if("boolean"===r)return t?j.True():j.False();if("number"===r||t instanceof Number){if(isNaN(t))throw new P.TypeError("Cannot wrap NaN! "+t);return Math.floor(t)-t!==0?j.Double(t):t>0?t<N?j.wrap_uint(t):j.wrap_ulong(t):t>B?j.wrap_int(t):j.wrap_long(t)}return t instanceof Date?j.wrap_timestamp(t.getTime()):t instanceof n?t:t instanceof e?j.wrap_binary(t):"undefined"===r||null===t?j.Null():Array.isArray(t)?j.wrap_list(t):j.wrap_map(t)},j.wrap_described=function(t,e){var r=j.wrap(t);return e&&("string"==typeof e?r=j.described(j.wrap_string(e),r):("number"==typeof e||e instanceof Number)&&(r=j.described(j.wrap_ulong(e),r))),r},j.wrap_message_id=function(t){var e=typeof t;if("string"===e)return j.wrap_string(t);if("number"===e||t instanceof Number)return j.wrap_ulong(t);throw new P.TypeError("invalid message id:"+t)};var M={};j.unwrap_map_simple=function(t){return b(t.value.map(function(t){return j.unwrap(t,!0)}))},j.unwrap=function(t,e){if(t instanceof n){if(t.descriptor){var r=M[t.descriptor.value];if(r)return new r(t.value);if(e)return t}var i=j.unwrap(t.value,!0);return j.is_map(t)?b(i):i}return Array.isArray(t)?t.map(function(t){return j.unwrap(t,!0)}):t},j.described_nc=function(t,e){return t.length?(e.descriptor=t.shift(),j.described(t,e)):(e.descriptor=t,e)},j.described=j.described_nc,j.Reader=function(t){this.buffer=t,this.position=0},j.Reader.prototype.read_typecode=function(){return this.read_uint(1)},j.Reader.prototype.read_uint=function(t){var e=this.position;if(this.position+=t,1===t)return this.buffer.readUInt8(e);if(2===t)return this.buffer.readUInt16BE(e);if(4===t)return this.buffer.readUInt32BE(e);throw new P.TypeError("Unexpected width for uint "+t)},j.Reader.prototype.read_fixed_width=function(t){var e=this.position;return this.position+=t.width,t.read?t.read(this.buffer,e):this.buffer.slice(e,this.position)},j.Reader.prototype.read_variable_width=function(t){var e=this.read_uint(t.width),r=this.read_bytes(e);return t.encoding?r.toString(t.encoding):r},j.Reader.prototype.read=function(){var t=this.read_constructor(),e=this.read_value(E(t.typecode));return t.descriptor?j.described_nc(t.descriptor,e):e},j.Reader.prototype.read_constructor=function(){var t=this.read_typecode();if(0===t){var e=[];e.push(this.read());for(var r=this.read_constructor();r.descriptor;)e.push(r.descriptor),r=this.read_constructor();return{typecode:r.typecode,descriptor:1===e.length?e[0]:e}}return{typecode:t}},j.Reader.prototype.read_value=function(t){if(0===t.width)return t.create();if(t.category===T)return t.create(this.read_fixed_width(t));if(t.category===U)return t.create(this.read_variable_width(t));if(t.category===R)return this.read_compound(t);if(t.category===I)return this.read_array(t);throw new P.TypeError("Invalid category for type: "+t)},j.Reader.prototype.read_array_items=function(t,e){for(var r=[];r.length<t;)r.push(this.read_value(e));return r},j.Reader.prototype.read_n=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=this.read();return e},j.Reader.prototype.read_size_count=function(t){return{size:this.read_uint(t),count:this.read_uint(t)}},j.Reader.prototype.read_compound=function(t){var e=this.read_size_count(t.width);return t.create(this.read_n(e.count))},j.Reader.prototype.read_array=function(t){var e=this.read_size_count(t.width),r=this.read_constructor();return t.create(this.read_array_items(e.count,E(r.typecode)),r.typecode,r.descriptor)},j.Reader.prototype.toString=function(){var t="buffer@"+this.position;this.position&&(t+=": ");for(var e=this.position;e<this.buffer.length;e++)e>0&&(t+=","),t+="0x"+Number(this.buffer[e]).toString(16);return t},j.Reader.prototype.reset=function(){this.position=0},j.Reader.prototype.skip=function(t){this.position+=t},j.Reader.prototype.read_bytes=function(t){var e=this.position;return this.position+=t,this.buffer.slice(e,this.position)},j.Reader.prototype.remaining=function(){return this.buffer.length-this.position},j.Writer=function(t){this.buffer=t?t:new e(1024),this.position=0;
},j.Writer.prototype.toBuffer=function(){return this.buffer.slice(0,this.position)},j.Writer.prototype.ensure=function(t){if(this.buffer.length<t){var r=new e(x(2*this.buffer.length,t));this.buffer.copy(r),this.buffer=r}},j.Writer.prototype.write_typecode=function(t){this.write_uint(t,1)},j.Writer.prototype.write_uint=function(t,e){var r=this.position;if(this.ensure(this.position+e),this.position+=e,1===e)return this.buffer.writeUInt8(t,r);if(2===e)return this.buffer.writeUInt16BE(t,r);if(4===e)return this.buffer.writeUInt32BE(t,r);throw new P.TypeError("Unexpected width for uint "+e)},j.Writer.prototype.write_fixed_width=function(t,e){var r=this.position;if(this.ensure(this.position+t.width),this.position+=t.width,t.write)t.write(this.buffer,e,r);else{if(!e.copy)throw new P.TypeError("Cannot handle write for "+t);e.copy(this.buffer,r)}},j.Writer.prototype.write_variable_width=function(t,r){var n=t.encoding?new e(r,t.encoding):new e(r);this.write_uint(n.length,t.width),this.write_bytes(n)},j.Writer.prototype.write_bytes=function(t){var e=this.position;this.ensure(this.position+t.length),this.position+=t.length,t.copy(this.buffer,e)},j.Writer.prototype.write_constructor=function(t,e){e&&(this.write_typecode(0),this.write(e)),this.write_typecode(t)},j.Writer.prototype.write=function(t){if(void 0===t.type)throw new P.TypeError("Cannot write "+JSON.stringify(t));this.write_constructor(t.type.typecode,t.descriptor),this.write_value(t.type,t.value,t.array_constructor)},j.Writer.prototype.write_value=function(t,e,r){if(0!==t.width)if(t.category===T)this.write_fixed_width(t,e);else if(t.category===U)this.write_variable_width(t,e);else if(t.category===R)this.write_compound(t,e);else{if(t.category!==I)throw new P.TypeError("Invalid category "+t.category+" for type: "+t);this.write_array(t,e,r)}},j.Writer.prototype.backfill_size=function(t,e){var r=this.position-e;this.position=e,this.write_uint(r-t,t),this.position+=r-t},j.Writer.prototype.write_compound=function(t,e){var r=this.position;this.position+=t.width,this.write_uint(e.length,t.width);for(var n=0;n<e.length;n++)void 0===e[n]||null===e[n]?this.write(j.Null()):this.write(e[n]);this.backfill_size(t.width,r)},j.Writer.prototype.write_array=function(t,e,r){var n=this.position;this.position+=t.width,this.write_uint(e.length,t.width),this.write_constructor(r.typecode,r.descriptor);for(var i=E(r.typecode),o=0;o<e.length;o++)this.write_value(i,e[o]);this.backfill_size(t.width,n)},j.Writer.prototype.toString=function(){var t="buffer@"+this.position;this.position&&(t+=": ");for(var e=0;e<this.position;e++)e>0&&(t+=","),t+=("00"+Number(this.buffer[e]).toString(16)).slice(-2);return t},j.Writer.prototype.skip=function(t){this.ensure(this.position+t),this.position+=t},j.Writer.prototype.clear=function(){this.buffer.fill(0),this.position=0},j.Writer.prototype.remaining=function(){return this.buffer.length-this.position},j.define_composite=function(t){var e=function(t){this.value=t?t:[]};e.descriptor={numeric:t.code,symbolic:"amqp:"+t.name+":list"},e.prototype.dispatch=function(e,r){e["on_"+t.name](r)};for(var r=0;r<t.fields.length;r++){var n=t.fields[r];Object.defineProperty(e.prototype,n.name,k(r,n))}return e.toString=function(){return t.name+"#"+Number(t.code).toString(16)},e.prototype.toJSON=function(){var t={};t.type=e.toString();for(var r in this)"value"!==r&&this[r]&&(t[r]=this[r]);return t},e.create=function(t){var r=new e;for(var n in t)r[n]=t[n];return r},e.prototype.described=function(){return j.described_nc(j.wrap_ulong(e.descriptor.numeric),j.wrap_list(this.value))},e},O({name:"error",code:29,fields:[{name:"condition",type:"symbol",mandatory:!0},{name:"description",type:"string"},{name:"info",type:"map"}]}),t.exports=j}).call(e,r(1).Buffer)},function(t,e,r){"use strict";function n(t,e){var r=i.define_composite(e);s[e.name]=r.create,a[Number(r.descriptor.numeric).toString(10)]=r,a[r.descriptor.symbolic]=r}var i=r(4),o=r(2),s={},a={};s.read_header=function(t){var e=4,r={},n=t.toString("ascii",0,e);if("AMQP"!==n)throw new o.ProtocolError("Invalid protocol header for AMQP "+n);if(r.protocol_id=t.readUInt8(e++),r.major=t.readUInt8(e++),r.minor=t.readUInt8(e++),r.revision=t.readUInt8(e++),0===r.protocol_id&&0===r.major&&9===r.minor&&1===r.revision)throw new o.ProtocolError("Unsupported AMQP version: 0-9-1");if(1===r.protocol_id&&1===r.major&&0===r.minor&&10===r.revision)throw new o.ProtocolError("Unsupported AMQP version: 0-10");if(1!==r.major||0!==r.minor)throw new o.ProtocolError("Unsupported AMQP version: "+JSON.stringify(r));return r},s.write_header=function(t,e){var r=4;return t.write("AMQP",0,r,"ascii"),t.writeUInt8(e.protocol_id,r++),t.writeUInt8(e.major,r++),t.writeUInt8(e.minor,r++),t.writeUInt8(e.revision,r++),8},s.TYPE_AMQP=0,s.TYPE_SASL=1,s.read_frame=function(t){var e=new i.Reader(t),r={};if(r.size=e.read_uint(4),e.remaining<r.size)return null;var n=e.read_uint(1);if(n<2)throw new o.ProtocolError("Invalid data offset, must be at least 2 was "+n);if(r.type=e.read_uint(1),r.type===s.TYPE_AMQP)r.channel=e.read_uint(2);else{if(r.type!==s.TYPE_SASL)throw new o.ProtocolError("Unknown frame type "+r.type);e.skip(2)}if(n>1&&e.skip(4*n-8),e.remaining()){r.performative=e.read();var c=a[r.performative.descriptor.value];c&&(r.performative=new c(r.performative.value)),e.remaining()&&(r.payload=e.read_bytes(e.remaining()))}return r},s.write_frame=function(t){var e=new i.Writer;if(e.skip(4),e.write_uint(2,1),e.write_uint(t.type,1),t.type===s.TYPE_AMQP)e.write_uint(t.channel,2);else{if(t.type!==s.TYPE_SASL)throw new o.ProtocolError("Unknown frame type "+t.type);e.write_uint(0,2)}t.performative&&(e.write(t.performative),t.payload&&e.write_bytes(t.payload));var r=e.toBuffer();return r.writeUInt32BE(r.length,0),r},s.amqp_frame=function(t,e,r){return{channel:t||0,type:s.TYPE_AMQP,performative:e,payload:r}},s.sasl_frame=function(t){return{channel:0,type:s.TYPE_SASL,performative:t}};var c={name:"open",code:16,fields:[{name:"container_id",type:"string",mandatory:!0},{name:"hostname",type:"string"},{name:"max_frame_size",type:"uint",default_value:4294967295},{name:"channel_max",type:"ushort",default_value:65535},{name:"idle_time_out",type:"uint"},{name:"outgoing_locales",type:"symbol",multiple:!0},{name:"incoming_locales",type:"symbol",multiple:!0},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]},u={name:"begin",code:17,fields:[{name:"remote_channel",type:"ushort"},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"incoming_window",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle_max",type:"uint",default_value:"4294967295"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]},h={name:"attach",code:18,fields:[{name:"name",type:"string",mandatory:!0},{name:"handle",type:"uint",mandatory:!0},{name:"role",type:"boolean",mandatory:!0},{name:"snd_settle_mode",type:"ubyte",default_value:2},{name:"rcv_settle_mode",type:"ubyte",default_value:0},{name:"source",type:"*"},{name:"target",type:"*"},{name:"unsettled",type:"map"},{name:"incomplete_unsettled",type:"boolean",default_value:!1},{name:"initial_delivery_count",type:"uint"},{name:"max_message_size",type:"ulong"},{name:"offered_capabilities",type:"symbol",multiple:!0},{name:"desired_capabilities",type:"symbol",multiple:!0},{name:"properties",type:"symbolic_map"}]},p={name:"flow",code:19,fields:[{name:"next_incoming_id",type:"uint"},{name:"incoming_window",type:"uint",mandatory:!0},{name:"next_outgoing_id",type:"uint",mandatory:!0},{name:"outgoing_window",type:"uint",mandatory:!0},{name:"handle",type:"uint"},{name:"delivery_count",type:"uint"},{name:"link_credit",type:"uint"},{name:"available",type:"uint"},{name:"drain",type:"boolean",default_value:!1},{name:"echo",type:"boolean",default_value:!1},{name:"properties",type:"symbolic_map"}]},l={name:"transfer",code:20,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"delivery_id",type:"uint"},{name:"delivery_tag",type:"binary"},{name:"message_format",type:"uint"},{name:"settled",type:"boolean"},{name:"more",type:"boolean",default_value:!1},{name:"rcv_settle_mode",type:"ubyte"},{name:"state",type:"delivery_state"},{name:"resume",type:"boolean",default_value:!1},{name:"aborted",type:"boolean",default_value:!1},{name:"batchable",type:"boolean",default_value:!1}]},f={name:"disposition",code:21,fields:[{name:"role",type:"boolean",mandatory:!0},{name:"first",type:"uint",mandatory:!0},{name:"last",type:"uint"},{name:"settled",type:"boolean",default_value:!1},{name:"state",type:"*"},{name:"batchable",type:"boolean",default_value:!1}]},d={name:"detach",code:22,fields:[{name:"handle",type:"uint",mandatory:!0},{name:"closed",type:"boolean",default_value:!1},{name:"error",type:"error"}]},_={name:"end",code:23,fields:[{name:"error",type:"error"}]},m={name:"close",code:24,fields:[{name:"error",type:"error"}]};n(s.TYPE_AMQP,c),n(s.TYPE_AMQP,u),n(s.TYPE_AMQP,h),n(s.TYPE_AMQP,p),n(s.TYPE_AMQP,l),n(s.TYPE_AMQP,f),n(s.TYPE_AMQP,d),n(s.TYPE_AMQP,_),n(s.TYPE_AMQP,m);var y={name:"sasl_mechanisms",code:64,fields:[{name:"sasl_server_mechanisms",type:"symbol",multiple:!0,mandatory:!0}]},v={name:"sasl_init",code:65,fields:[{name:"mechanism",type:"symbol",mandatory:!0},{name:"initial_response",type:"binary"},{name:"hostname",type:"string"}]},g={name:"sasl_challenge",code:66,fields:[{name:"challenge",type:"binary",mandatory:!0}]},w={name:"sasl_response",code:67,fields:[{name:"response",type:"binary",mandatory:!0}]},b={name:"sasl_outcome",code:68,fields:[{name:"code",type:"ubyte",mandatory:!0},{name:"additional_data",type:"binary"}]};n(s.TYPE_SASL,y),n(s.TYPE_SASL,v),n(s.TYPE_SASL,g),n(s.TYPE_SASL,w),n(s.TYPE_SASL,b),t.exports=s},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,a,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var h=new Error('Uncaught, unspecified "error" event. ('+e+")");throw h.context=e,h}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,c=0;c<i;c++)u[c].apply(this,a);return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(a=s;a-- >0;)if(r[a]===e||r[a].listener&&r[a].listener===e){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(h===setTimeout)return setTimeout(t,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(t,0);try{return h(t,0)}catch(e){try{return h.call(null,t,0)}catch(e){return h.call(this,t,0)}}}function o(t){if(p===clearTimeout)return clearTimeout(t);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function s(){_&&f&&(_=!1,f.length?d=f.concat(d):m=-1,d.length&&a())}function a(){if(!_){var t=i(s);_=!0;for(var e=d.length;e;){for(f=d,d=[];++m<e;)f&&f[m].run();m=-1,e=d.length}f=null,_=!1,o(t)}}function c(t,e){this.fun=t,this.array=e}function u(){}var h,p,l=t.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(t){h=r}try{p="function"==typeof clearTimeout?clearTimeout:n}catch(t){p=n}}();var f,d=[],_=!1,m=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];d.push(new c(t,e)),1!==d.length||_||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=u,l.addListener=u,l.once=u,l.off=u,l.removeListener=u,l.removeAllListeners=u,l.emit=u,l.prependListener=u,l.prependOnceListener=u,l.listeners=function(t){return[]},l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},function(t,e,r){(function(t){var e=r(8);for(k in e)t[k]=e[k]}).call(e,function(){return this}())},function(t,e){"use strict";var r=function(){this.init()};r.prototype.init=function(){this.local_open=!1,this.remote_open=!1,this.open_requests=0,this.close_requests=0,this.initialised=!1},r.prototype.open=function(){return this.initialised=!0,!this.local_open&&(this.local_open=!0,this.open_requests++,!0)},r.prototype.close=function(){return!!this.local_open&&(this.local_open=!1,this.close_requests++,!0)},r.prototype.disconnected=function(){var t=this.initialised,e=this.local_open;this.init(),this.initialised=t,e?this.open():this.close()},r.prototype.remote_opened=function(){return!this.remote_open&&(this.remote_open=!0,!0)},r.prototype.remote_closed=function(){return!!this.remote_open&&(this.remote_open=!1,!0)},r.prototype.is_open=function(){return this.local_open&&this.remote_open},r.prototype.is_closed=function(){return this.initialised&&!this.local_open&&!this.remote_open},r.prototype.has_settled=function(){return 0===this.open_requests&&0===this.close_requests},r.prototype.need_open=function(){return this.open_requests>0&&(this.open_requests--,!0)},r.prototype.need_close=function(){return this.close_requests>0&&(this.close_requests--,!0)},t.exports=r},function(t,e,r){"use strict";function n(t,e,r){e.descriptor=t,d[t.symbolic]=e,d[Number(t.numeric).toString(10)]=e,r&&_.push(r)}function i(t){var e=l.define_composite(t);m[t.name]=e.create,f[Number(e.descriptor.numeric).toString(10)]=e,f[e.descriptor.symbolic]=e;var r=function(r,n){for(var i=new e(n.value),o=0;o<t.fields.length;o++){var s=t.fields[o],a=i[s.name];void 0!==a&&null!==a&&(r[s.name]=a)}},i=function(t,r){t.push(e.create(r).described())};n(e.descriptor,r,i)}function o(t){var e={numeric:t.code};e.symbolic="amqp:"+t.name.replace(/_/g,"-")+":map";var r=function(e,r){e[t.name]=l.unwrap_map_simple(r)},i=function(r,n){n[t.name]&&r.push(l.described_nc(l.wrap_ulong(e.numeric),l.wrap_map(n[t.name])))};n(e,r,i)}function s(t,e){this.typecode=t,this.content=e}function a(t,e){e.body&&e.body.constructor===s?t.push(e.body.described()):t.push(l.described(l.wrap_ulong(119),l.wrap(e.body)))}function c(t,e){for(var r in t){var n=t[r];"object"==typeof n?c(n,e[r]):e[r]=n}}function u(t){t&&c(t,this)}function h(t){var e=l.define_composite(t);e.composite_type=t.name,m[t.name]=e.create,y[Number(e.descriptor.numeric).toString(10)]=e,y[e.descriptor.symbolic]=e,m["is_"+t.name]=function(e){if(e&&e.descriptor){var r=y[e.descriptor.value];if(r)return r.descriptor.numeric===t.code}return!1}}var p=r(3),l=r(4),f={},d={},_=[],m={};s.prototype.described=function(){return l.described(l.wrap_ulong(this.typecode),l.wrap(this.content))},i({name:"header",code:112,fields:[{name:"durable",type:"boolean",default_value:!1},{name:"priority",type:"ubyte",default_value:4},{name:"ttl",type:"uint"},{name:"first_acquirer",type:"boolean",default_value:!1},{name:"delivery_count",type:"uint",default_value:0}]}),o({name:"delivery_annotations",code:113}),o({name:"message_annotations",code:114}),i({name:"properties",code:115,fields:[{name:"message_id",type:"message_id"},{name:"user_id",type:"binary"},{name:"to",type:"string"},{name:"subject",type:"string"},{name:"reply_to",type:"string"},{name:"correlation_id",type:"message_id"},{name:"content_type",type:"symbol"},{name:"content_encoding",type:"symbol"},{name:"absolute_expiry_time",type:"timestamp"},{name:"creation_time",type:"timestamp"},{name:"group_id",type:"string"},{name:"group_sequence",type:"uint"},{name:"reply_to_group_id",type:"string"}]}),o({name:"application_properties",code:116}),n({numeric:117,symbolic:"amqp:data:binary"},function(t,e){t.body=new s(117,l.unwrap(e))}),n({numeric:118,symbolic:"amqp:amqp-sequence:list"},function(t,e){t.body=new s(118,l.unwrap(e))}),n({numeric:119,symbolic:"amqp:value:*"},function(t,e){t.body=l.unwrap(e)}),o({name:"footer",code:120}),_.push(a),m.data_section=function(t){return new s(117,t)},m.sequence_section=function(t){return new s(118,t)},u.prototype.toJSON=function(){var t={};for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},u.prototype.inspect=function(){return JSON.stringify(this.toJSON())},u.prototype.toString=function(){return JSON.stringify(this.toJSON())},m.encode=function(t){var e=[];_.forEach(function(r){r(e,t)});for(var r=new l.Writer,n=0;n<e.length;n++)p.message("Encoding section %d of %d: %o",n+1,e.length,e[n]),r.write(e[n]);var i=r.toBuffer();return p.message("encoded %d bytes",i.length),i},m.decode=function(t){for(var e=new u,r=new l.Reader(t);r.remaining();){var n=r.read();if(p.message("decoding section: %o of type: %o",n,n.descriptor),n.descriptor){var i=d[n.descriptor.value];i?i(e,n):console.warn("WARNING: did not recognise message section with descriptor "+n.descriptor)}else console.warn("WARNING: expected described message section got "+JSON.stringify(n))}return e};var y={};m.unwrap_outcome=function(t){if(t&&t.descriptor){var e=y[t.descriptor.value];if(e)return new e(t.value)}return console.error("unrecognised outcome: "+JSON.stringify(t)),t},m.are_outcomes_equivalent=function(t,e){return void 0===t&&void 0===e||void 0!==t&&void 0!==e&&t.descriptor.value===e.descriptor.value&&36===t.descriptor.value},h({name:"received",code:35,fields:[{name:"section_number",type:"uint",mandatory:!0},{name:"section_offset",type:"ulong",mandatory:!0}]}),h({name:"accepted",code:36,fields:[]}),h({name:"rejected",code:37,fields:[{name:"error",type:"error"}]}),h({name:"released",code:38,fields:[]}),h({name:"modified",code:39,fields:[{name:"delivery_failed",type:"boolean"},{name:"undeliverable_here",type:"boolean"},{name:"message_annotations",type:"map"}]}),t.exports=m},function(t,e,r){(function(e){"use strict";var n=r(2),i={};i.generate_uuid=function(){return i.uuid_to_string(i.uuid4())},i.uuid4=function(){for(var t=new e(16),r=0;r<t.length;r++)t[r]=255*Math.random()|0;return t[7]&=15,t[7]|=64,t[8]&=63,t[8]|=128,t},i.uuid_to_string=function(t){if(16===t.length){var e=[t.slice(0,4),t.slice(4,6),t.slice(6,8),t.slice(8,10),t.slice(10,16)];return e.map(function(t){return t.toString("hex")}).join("-")}throw new n.TypeError("Not a UUID, expecting 16 byte buffer")},i.clone=function(t){for(var e=Object.create(t.prototype||{}),r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var i=r[n];e[i]=t[i]}return e},i.and=function(t,e){return void 0===e?t:function(r){return t(r)&&e(r)}},i.is_sender=function(t){return t.is_sender()},i.is_receiver=function(t){return t.is_receiver()},i.sender_filter=function(t){return i.and(i.is_sender,t)},i.receiver_filter=function(t){return i.and(i.is_receiver,t)},t.exports=i}).call(e,r(1).Buffer)},function(t,e){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function(){function t(e){if(r(this,t),"number"!=typeof e)throw new Error("Width must be a number");if(e<3||e>10)throw new Error("Width cannot be less than 3 or greater than 10");this.board=[];for(var n=0;n<e;n++){for(var i=[],o=0;o<e;o++)i.push(0);this.board.push(i)}}return n(t,[{key:"getDim",value:function(){return this.board.length}},{key:"getCell",value:function(t,e){return this.board[t][e]}},{key:"move",value:function(t,e,r){this.board[t][e]=r}},{key:"getEmptyCells",value:function(){return this.board.map(function(t,e){return t.map(function(t,r){if(0===t)return[e,r]})}).reduce(function(t,e){return t.concat(e)}).filter(function(t){return"undefined"!=typeof t})}},{key:"checkWin",value:function(){for(var e=!1,r=this.getDim(),n=0;n<r;n++){var i=this.board[n];if(t.allEqual(i)&&i[0]>0)return e=i[0]}for(var n=0;n<r;n++){for(var o=[],s=0;s<r;s++)o.push(this.getCell(s,n));if(t.allEqual(o)&&o[0]>0)return e=o[0]}for(var a={left:[],right:[]},c=0;c<r;c++)a.left.push(this.getCell(c,c)),a.right.push(this.getCell(r-c-1,c));for(var u in a){var h=a[u];if(t.allEqual(h)&&h[0]>0)return e=h[0]}var p=!this.board.reduce(function(t,e){return t.concat(e)}).some(function(t){return 0===t});return p&&(e=3),e}}],[{key:"allEqual",value:function(t){return!t.some(function(t,e,r){return t!==r[0]})}}]),t}();e.default=i,t.exports=e.default},function(t,e,r){(function(e){"use strict";function n(t){for(var e=[],r=0,n=0;n<t.length;)0===t[n]?(n>r?e.push(t.toString("utf8",r,n)):e.push(null),r=++n):++n;return n>r?e.push(t.toString("utf8",r,n)):e.push(null),e}var i=r(2),o=r(5),s=r(14),a={OK:0,AUTH:1,SYS:2,SYS_PERM:3,SYS_TEMP:4},c=3,u=function(t){this.callback=t,this.outcome=void 0,this.username=void 0};u.prototype.start=function(t,e){var r=n(t);3!==r.length&&this.connection.sasl_failed("Unexpected response in PLAIN, got "+r.length+" fields, expected 3"),this.callback(r[1],r[2],e)?(this.outcome=!0,this.username=r[1]):this.outcome=!1};var h=function(t,e){this.username=t,this.password=e};h.prototype.start=function(){var t=new e(1+this.username.length+1+this.password.length);return t.writeUInt8(0,0),t.write(this.username,1),t.writeUInt8(0,1+this.username.length),t.write(this.password,1+this.username.length+1),t};var p=function(){this.outcome=void 0,this.username=void 0};p.prototype.start=function(t){this.outcome=!0,this.username=t?t.toString("utf8"):"anonymous"};var l=function(t){this.username=t?t:"anonymous"};l.prototype.start=function(){var t=new e(1+this.username.length);return t.writeUInt8(0,0),t.write(this.username,1),t};var f=function(){this.outcome=void 0,this.username=void 0};f.prototype.start=function(){this.outcome=!0};var d=function(){this.username=void 0};d.prototype.start=function(){return""},d.prototype.step=function(){return""};var _=function(t,e){this.connection=t,this.transport=new s(t.amqp_transport.identifier,c,o.TYPE_SASL,this),this.next=t.amqp_transport,this.mechanisms=e,this.mechanism=void 0,this.outcome=void 0,this.username=void 0;var r=Object.getOwnPropertyNames(e);this.transport.encode(o.sasl_frame(o.sasl_mechanisms({sasl_server_mechanisms:r}).described()))};_.prototype.do_step=function(t){void 0===this.mechanism.outcome?this.transport.encode(o.sasl_frame(o.sasl_challenge({challenge:t}).described())):(this.outcome=this.mechanism.outcome?a.OK:a.AUTH,this.transport.encode(o.sasl_frame(o.sasl_outcome({code:this.outcome}).described())),this.outcome===a.OK&&(this.username=this.mechanism.username,this.transport.write_complete=!0,this.transport.read_complete=!0))},_.prototype.on_sasl_init=function(t){var e=this.mechanisms[t.performative.mechanism];if(e){this.mechanism=e();var r=this.mechanism.start(t.performative.initial_response,t.performative.hostname);this.do_step(r)}else this.outcome=a.AUTH,this.transport.encode(o.sasl_frame(o.sasl_outcome({code:this.outcome}).described()))},_.prototype.on_sasl_response=function(t){this.do_step(this.mechanism.step(t.performative.response))},_.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},_.prototype.write=function(t){return this.transport.write_complete&&0===this.transport.pending.length?this.next.write(t):this.transport.write(t)},_.prototype.read=function(t){return this.transport.read_complete?this.next.read(t):this.transport.read(t)};var m=function(t,e,r){this.connection=t,this.transport=new s(t.amqp_transport.identifier,c,o.TYPE_SASL,this),this.next=t.amqp_transport,this.mechanisms=e,this.mechanism=void 0,this.mechanism_name=void 0,this.hostname=r,this.failed=!1};m.prototype.on_sasl_mechanisms=function(t){for(var e=0;void 0===this.mechanism&&e<t.performative.sasl_server_mechanisms.length;e++){var r=t.performative.sasl_server_mechanisms[e],n=this.mechanisms[r];n&&(this.mechanism=n(),this.mechanism_name=r)}if(this.mechanism){var i=this.mechanism.start(),s={mechanism:this.mechanism_name,initial_response:i};this.hostname&&(s.hostname=this.hostname),this.transport.encode(o.sasl_frame(o.sasl_init(s).described()))}else this.failed=!0,this.connection.sasl_failed("No suitable mechanism; server supports "+t.performative.sasl_server_mechanisms)},m.prototype.on_sasl_challenge=function(t){var e=this.mechanism.step(t.performative.challenge);this.transport.encode(o.sasl_frame(o.sasl_response({response:e}).described()))},m.prototype.on_sasl_outcome=function(t){switch(t.performative.code){case a.OK:this.transport.read_complete=!0,this.transport.write_complete=!0;break;default:this.transport.write_complete=!0,this.connection.sasl_failed("Failed to authenticate: "+t.performative.code)}},m.prototype.has_writes_pending=function(){return this.transport.has_writes_pending()||this.next.has_writes_pending()},m.prototype.write=function(t){return this.transport.write_complete?this.next.write(t):this.transport.write(t)},m.prototype.read=function(t){return this.transport.read_complete?this.next.read(t):this.transport.read(t)};var y=function(t,e){this.header_received=!1,this.transports={0:t.amqp_transport,3:new _(t,e)},this.selected=void 0};y.prototype.has_writes_pending=function(){return this.header_received&&this.selected.has_writes_pending()},y.prototype.write=function(t){return this.selected?this.selected.write(t):0},y.prototype.read=function(t){if(!this.header_received){if(t.length<8)return 0;if(this.header_received=o.read_header(t),this.selected=this.transports[this.header_received.protocol_id],void 0===this.selected)throw new i.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id)}return this.selected.read(t)};var v={enable_anonymous:function(){this.ANONYMOUS=function(){return new p}},enable_plain:function(t){this.PLAIN=function(){return new u(t)}}},g={enable_anonymous:function(t){this.ANONYMOUS=function(){return new l(t)}},enable_plain:function(t,e){this.PLAIN=function(){return new h(t,e)}},enable_external:function(){this.EXTERNAL=function(){return new d}}};t.exports={Client:m,Server:_,Selective:y,server_mechanisms:function(){return Object.create(v)},client_mechanisms:function(){return Object.create(g)},server_add_external:function(t){return t.EXTERNAL=function(){return new f},t}}}).call(e,r(1).Buffer)},function(t,e,r){(function(e){"use strict";var n=r(2),i=r(5),o=r(3),s=function(t,e,r,n){this.identifier=t,this.protocol_id=e,this.frame_type=r,this.handler=n,this.pending=[],this.header_sent=void 0,this.header_received=void 0,this.write_complete=!1,this.read_complete=!1};s.prototype.has_writes_pending=function(){return this.pending.length>0},s.prototype.encode=function(t){var e=i.write_frame(t);o.frames("[%s] PENDING: %o",this.identifier,JSON.stringify(t)),this.pending.push(e)},s.prototype.write=function(t){if(!this.header_sent){var r=new e(8),n={protocol_id:this.protocol_id,major:1,minor:0,revision:0};i.write_header(r,n),t.write(r),this.header_sent=n}for(var s=0;s<this.pending.length;s++)t.write(this.pending[s]),o.raw("[%s] SENT: %o",this.identifier,this.pending[s]);this.pending=[]},s.prototype.read=function(t){var e=0;if(!this.header_received){if(t.length<8)return e;if(this.header_received=i.read_header(t),o.frames("[%s] RECV: %o",this.identifier,this.header_received),this.header_received.protocol_id!==this.protocol_id)throw 3===this.protocol_id&&0===this.header_received.protocol_id?new n.ProtocolError("Expecting SASL layer"):0===this.protocol_id&&3===this.header_received.protocol_id?new n.ProtocolError("SASL layer not enabled"):new n.ProtocolError("Invalid AMQP protocol id "+this.header_received.protocol_id+" expecting: "+this.protocol_id);e=8}for(;e<t.length-4&&!this.read_complete;){var r=t.readUInt32BE(e);if(o.io("[%s] got frame of size %d",this.identifier,r),t.length<e+r){o.io("[%s] incomplete frame; have only %d of %d",this.identifier,t.length-e,r);break}var s=i.read_frame(t.slice(e,e+r));if(o.frames("[%s] RECV: %o",this.identifier,JSON.stringify(s)),s.type!==this.frame_type)throw new n.ProtocolError("Invalid frame type: "+s.type);e+=r,s.performative&&s.performative.dispatch(this.handler,s)}return e},t.exports=s}).call(e,r(1).Buffer)},function(t,e){function r(t){return t="[object "+t+"]",function(e){return o.call(e)===t}}var n=Function.prototype.bind,i=Array.prototype.slice,o=Object.prototype.toString;e.bind=function(t,e){var r=i.call(arguments,2);return n?(r.unshift(e),n.apply(t,r)):function(){return t.apply(e,r.concat(i.call(arguments)))}},e.slice=function(t,e,r){return i.call(t,e,r)},e.toString=function(t){return o.call(t)},e.isNull=r("Null"),e.isDate=r("Date"),e.isMath=r("Math"),e.isJSON=r("JSON"),e.isError=r("Error"),e.isArray=Array.isArray||r("Array"),e.isObject=r("Object"),e.isRegExp=r("RegExp"),e.isNumber=r("Number"),e.isString=r("String"),e.isBoolean=r("Boolean"),e.isFunction=r("Function"),e.isArguments=r("Arguments"),e.isUndefined=r("Undefined"),e.isValid=function(t){return!e.isInvalid(t)},e.isInvalid=function(t){return e.isNull(t)||e.isUndefined(t);
},e.isImmutable=function(t){return!e.isMutable(t)},e.isMutable=function(t){return t&&!e.isNumber(t)&&!e.isString(t)&&!e.isBoolean(t)},e.isEnumerable=function(t){return!!t&&(e.isNumber(t)?e.isInteger(t):e.isInteger(t.length)?t.length>=0:e.isEnumerableObject(t))},e.isEnumerableObject=function(t){for(var e in t)return!0;return!1},e.isEmpty=function(t){return e.isObject(t)?!e.isEnumerableObject(t):!e.isEnumerable(t)},e.isFiniteNumber=function(t){return e.isNumber(t)&&isFinite(t)},e.isInteger=function(t){return e.isFiniteNumber(t)&&Math.floor(t)===t},e.isVague=function(t){return t&&"object"==typeof t},e.isList=function(t){return e.isVague(t)&&e.isInteger(t.length)&&t.length>=0},e.isNaN=isNaN,e.nativeTypeOf=function(t){var e=t.toString(t);return e.substring(8,e.length-1)},e.typeOf=function(t){return e.isObject(t)?t.constructor.name||"Object":e.nativeTypeOf(t)},e.safeApply=function(t,r,n){return e.isFunction(t)?t.apply(n||this,r):void 0},e.enumerate=function(t,r,n,i){if(!t)return t;if(n=n||this,!i&&e.isFunction(t.forEach))return t.forEach(r,n);var o=0,s=t.length;if(e.isString(t))for(;o<s;o+=1)r.call(n,t.charAt(o),o,t);if(e.isList(t))for(;o<s;o+=1)r.call(n,t[o],o,t);else if(e.isInteger(t))for(t<0?(s=0,o=t):s=t;o<s;o+=1)r.call(n,o,Math.abs(o),t);else e.enumerateObject(t,r,n);return t},e.enumerateObject=function(t,e,r){var n;for(n in t)e.call(r,t[n],n,t);return t},e.assignAll=function(t,r,n,i,o){return e.isMutable(t)?(o="enumerate"===o?o:"enumerateObject",e[o](r,function(r,o){e.safeApply(n,arguments,i||t)||(t[o]=r)}),t):t},e.assignList=function(t,r,n,i){return e.assignAll(t,r,n,i,"enumerate")},e.assign=function(t,r,n,i){return e.assignAll(t,r,function(t,o){return!r.hasOwnProperty(o)||e.safeApply(n,arguments,i||this)},i)},e.toArray=function(t,r,n){return e.isArray()?e.isInteger(r)?e.slice(t,r,n):t:e.isArguments(t)||e.isString(t)?e.slice(t,r,n):e.isList(t)?(e.isInteger(n)||(n=t.length),r=r||0,e.assignList([],t,function(t,e){return r>e||e>=n})):void 0}},function(t,e,r){(function(t,n){function i(t,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),_(r)?n.showHidden=r:r&&e._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,t,n.depth)}function o(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}function c(t,r,n){if(t.customInspect&&r&&k(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,t);return g(i)||(i=c(t,i,n)),i}var o=u(t,r);if(o)return o;var s=Object.keys(r),_=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),S(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(r);if(0===s.length){if(k(r)){var m=r.name?": "+r.name:"";return t.stylize("[Function"+m+"]","special")}if(E(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(A(r))return t.stylize(Date.prototype.toString.call(r),"date");if(S(r))return h(r)}var y="",v=!1,w=["{","}"];if(d(r)&&(v=!0,w=["[","]"]),k(r)){var b=r.name?": "+r.name:"";y=" [Function"+b+"]"}if(E(r)&&(y=" "+RegExp.prototype.toString.call(r)),A(r)&&(y=" "+Date.prototype.toUTCString.call(r)),S(r)&&(y=" "+h(r)),0===s.length&&(!v||0==r.length))return w[0]+y+w[1];if(n<0)return E(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special");t.seen.push(r);var x;return x=v?p(t,r,n,_,s):s.map(function(e){return l(t,r,n,_,e,v)}),t.seen.pop(),f(x,y,w)}function u(t,e){if(b(e))return t.stylize("undefined","undefined");if(g(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return v(e)?t.stylize(""+e,"number"):_(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)R(e,String(s))?o.push(l(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(l(t,e,r,n,i,!0))}),o}function l(t,e,r,n,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),R(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=m(r)?c(t,u.value,null):c(t,u.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function d(t){return Array.isArray(t)}function _(t){return"boolean"==typeof t}function m(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function E(t){return x(t)&&"[object RegExp]"===P(t)}function x(t){return"object"==typeof t&&null!==t}function A(t){return x(t)&&"[object Date]"===P(t)}function S(t){return x(t)&&("[object Error]"===P(t)||t instanceof Error)}function k(t){return"function"==typeof t}function O(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function P(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}function U(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),B[t.getMonth()],e].join(" ")}function R(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var I=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(t).replace(I,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),a=n[r];r<o;a=n[++r])s+=m(a)||!x(a)?" "+a:" "+i(a);return s},e.deprecate=function(r,i){function o(){if(!s){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),s=!0}return r.apply(this,arguments)}if(b(t.process))return function(){return e.deprecate(r,i).apply(this,arguments)};if(n.noDeprecation===!0)return r;var s=!1;return o};var j,N={};e.debuglog=function(t){if(b(j)&&(j=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!N[t])if(new RegExp("\\b"+t+"\\b","i").test(j)){var r=n.pid;N[t]=function(){var n=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,n)}}else N[t]=function(){};return N[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=_,e.isNull=m,e.isNullOrUndefined=y,e.isNumber=v,e.isString=g,e.isSymbol=w,e.isUndefined=b,e.isRegExp=E,e.isObject=x,e.isDate=A,e.isError=S,e.isFunction=k,e.isPrimitive=O,e.isBuffer=r(39);var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",U(),e.format.apply(e,arguments))},e.inherits=r(38),e._extend=function(t,e){if(!e||!x(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(e,function(){return this}(),r(7))},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=r(12),s=n(o),a={numTrials:1e3,trial:function(t){for(var e=this.trialBoard.getEmptyCells();this.trialBoard.checkWin()===!1;){var r=i(e[Math.floor(Math.random()*e.length)],2),n=r[0],o=r[1];this.trialBoard.move(n,o,t),e=this.trialBoard.getEmptyCells(),t=1===t?2:1}},updateScores:function(t){var e=this,r=this.trialBoard.checkWin(),n=2,i=1;r&&r<3&&!function(){var o=1===t?2:1;e.scores.forEach(function(s,a){s.forEach(function(s,c){e.trialBoard.getCell(a,c)===t?t===r?e.scores[a][c]+=n:e.scores[a][c]-=n:e.trialBoard.getCell(a,c)===o&&(t===r?e.scores[a][c]-=i:e.scores[a][c]+=i)})})}()},getBestMove:function(t){var e=this,r=void 0,n=t.getEmptyCells().map(function(t){var r=i(t,2),n=r[0],o=r[1];return{cell:[n,o],score:e.scores[n][o]}}).sort(function(t,e){return t.score<e.score}).filter(function(t,e,r){return t.score===r[0].score});return r=1===n.length?n[0].cell:n[Math.floor(Math.random()*n.length)].cell},clone:function t(e){var t=new s.default(e.getDim());return t.board=e.board.map(function(t){return t.slice()}),t},move:function(t,e){this.scores=new s.default(t.getDim()).board;for(var r=0;r<this.numTrials;r++)this.trialBoard=this.clone(t),this.trial(e),this.updateScores(e);return this.getBestMove(t)}};e.default=a,t.exports=e.default},function(t,e){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function n(t){return 3*t.length/4-r(t)}function i(t){var e,n,i,o,s,a=t.length;o=r(t),s=new h(3*a/4-o),n=o>0?a-4:a;var c=0;for(e=0;e<n;e+=4)i=u[t.charCodeAt(e)]<<18|u[t.charCodeAt(e+1)]<<12|u[t.charCodeAt(e+2)]<<6|u[t.charCodeAt(e+3)],s[c++]=i>>16&255,s[c++]=i>>8&255,s[c++]=255&i;return 2===o?(i=u[t.charCodeAt(e)]<<2|u[t.charCodeAt(e+1)]>>4,s[c++]=255&i):1===o&&(i=u[t.charCodeAt(e)]<<10|u[t.charCodeAt(e+1)]<<4|u[t.charCodeAt(e+2)]>>2,s[c++]=i>>8&255,s[c++]=255&i),s}function o(t){return c[t>>18&63]+c[t>>12&63]+c[t>>6&63]+c[63&t]}function s(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],i.push(o(n));return i.join("")}function a(t){for(var e,r=t.length,n=r%3,i="",o=[],a=16383,u=0,h=r-n;u<h;u+=a)o.push(s(t,u,u+a>h?h:u+a));return 1===n?(e=t[r-1],i+=c[e>>2],i+=c[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=c[e>>10],i+=c[e>>4&63],i+=c[e<<2&63],i+="="),o.push(i),o.join("")}e.byteLength=n,e.toByteArray=i,e.fromByteArray=a;for(var c=[],u=[],h="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=p.length;l<f;++l)c[l]=p[l],u[p.charCodeAt(l)]=l;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},function(t,e,r){(function(n){function i(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(t){var r=this.useColors;if(t[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+t[0]+(r?"%c ":" ")+"+"+e.humanize(this.diff),r){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var i=0,o=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,n)}}function s(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}}function c(){var t;try{t=e.storage.debug}catch(t){}return!t&&"undefined"!=typeof n&&"env"in n&&(t=n.env.DEBUG),t}function u(){try{return window.localStorage}catch(t){}}e=t.exports=r(20),e.log=s,e.formatArgs=o,e.save=a,e.load=c,e.useColors=i,e.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:u(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(c())}).call(e,r(7))},function(t,e,r){function n(t){var r,n=0;for(r in t)n=(n<<5)-n+t.charCodeAt(r),n|=0;return e.colors[Math.abs(n)%e.colors.length]}function i(t){function r(){if(r.enabled){var t=r,n=+new Date,i=n-(u||n);t.diff=i,t.prev=u,t.curr=n,u=n;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;a++;var i=e.formatters[n];if("function"==typeof i){var s=o[a];r=i.call(t,s),o.splice(a,1),a--}return r}),e.formatArgs.call(t,o);var c=r.log||e.log||console.log.bind(console);c.apply(t,o)}}return r.namespace=t,r.enabled=e.enabled(t),r.useColors=e.useColors(),r.color=n(t),"function"==typeof e.init&&e.init(r),r}function o(t){e.save(t),e.names=[],e.skips=[];for(var r=("string"==typeof t?t:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&(t=r[i].replace(/\*/g,".*?"),"-"===t[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))}function s(){e.enable("")}function a(t){var r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}e=t.exports=i.debug=i.default=i,e.coerce=c,e.disable=s,e.enable=o,e.enabled=a,e.humanize=r(23),e.names=[],e.skips=[],e.formatters={};var u},function(t,e){e.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,h=-7,p=r?i-1:0,l=r?-1:1,f=t[e+p];for(p+=l,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+t[e+p],p+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+p],p+=l,h-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:(f?-1:1)*(1/0);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},e.write=function(t,e,r,n,i,o){var s,a,c,u=8*o-i-1,h=(1<<u)-1,p=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,d=n?1:-1,_=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),e+=s+p>=1?l/c:l*Math.pow(2,1-p),e*c>=2&&(s++,c/=2),s+p>=h?(a=0,s=h):s+p>=1?(a=(e*c-1)*Math.pow(2,i),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;t[r+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+f]=255&s,f+=d,s/=256,u-=8);t[r+f-d]|=128*_}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e){function r(t){if(t=String(t),!(t.length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*h;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*a;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function n(t){return t>=u?Math.round(t/u)+"d":t>=c?Math.round(t/c)+"h":t>=a?Math.round(t/a)+"m":t>=s?Math.round(t/s)+"s":t+"ms"}function i(t){return o(t,u,"day")||o(t,c,"hour")||o(t,a,"minute")||o(t,s,"second")||t+" ms"}function o(t,e,r){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+r:Math.ceil(t/e)+" "+r+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,h=365.25*u;t.exports=function(t,e){e=e||{};var o=typeof t;if("string"===o&&t.length>0)return r(t);if("number"===o&&isNaN(t)===!1)return e.long?i(t):n(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,i){e=e||"&",n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(e);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var h,p,l,f,d=t[u].replace(s,"%20"),_=d.indexOf(n);_>=0?(h=d.substr(0,_),p=d.substr(_+1)):(h=d,p=""),l=decodeURIComponent(h),f=decodeURIComponent(p),r(o,l)?Array.isArray(o[l])?o[l].push(f):o[l]=[o[l],f]:o[l]=f}return o}},function(t,e){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,i){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(i){var o=encodeURIComponent(r(i))+n;return Array.isArray(t[i])?t[i].map(function(t){return o+encodeURIComponent(r(t))}).join(e):o+encodeURIComponent(r(t[i]))}).join(e):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(t)):""}},function(t,e,r){"use strict";e.decode=e.parse=r(24),e.encode=e.stringify=r(25)},function(t,e,r){(function(e,n){"use strict";function i(t){return t.get_id_string?t.get_id_string():t.localAddress+":"+t.localPort+" -> "+t.remoteAddress+":"+t.remotePort}function o(t){var e=null;return{get_session:function(){return e||(e=t.create_session(),e.begin()),e}}}function s(t,e){if(t){var r,n=t;return function(i){return r!==i&&(n=t,r=i),n--?e(i):-1}}return e}function a(t,e){var r,n=t;return function(i){r!==i&&(n=t,r=i);var o=n,s=2*n;return n=e>s?s:e,o}}function c(t){if(void 0===t.transport||"tcp"===t.transport)return E.connect;if("tls"===t.transport||"ssl"===t.transport)return x.connect;throw Error("Unrecognised transport: "+t.transport)}function u(t){var e={};return e.connect=t.connect?t.connect:c(t),e.host=t.host?t.host:"localhost",e.port=t.port?t.port:5672,e.options=t,e}function h(t){return function(){return this.remote.open?this.remote.open[t]:void 0}}function p(t){return t<16?"0x0"+Number(t).toString(16):"0x"+Number(t).toString(16)}function l(t){for(var e=[],r=0;r<t.length;r++)e.push(p(t[r]));return e.join(",")}function f(t){P.prototype["on_"+t]=function(e){var r=this.remote_channel_map[e.channel];if(!r)throw new d.ProtocolError(t+" received on invalid channel "+e.channel);r["on_"+t](e)}}var d=r(2),_=r(5),m=r(3),y=r(13),v=r(11),g=r(9),w=r(32),b=r(14),E=r(8),x=r(15),A=r(6).EventEmitter,S=0,k=["container_id","hostname","max_frame_size","channel_max","idle_time_out","outgoing_locales","incoming_locales","offered_capabilities","desired_capabilities","properties"],O=1,P=function(t,e){if(this.options={},t){for(var r in t)this.options[r]=t[r];"tls"!==t.transport&&"ssl"!==t.transport||void 0!==t.servername||void 0===t.host||(this.options.servername=t.host)}if(this.container=e,this.options.id||(this.options.id="connection-"+O++),this.options.container_id||(this.options.container_id=e?e.id:v.generate_uuid()),!this.options.connection_details){var n=this;this.options.connection_details=function(){return u(n.options)}}var i=this.get_option("reconnect",!0);if("boolean"==typeof i&&i){var c=this.get_option("initial_reconnect_delay",100),p=this.get_option("max_reconnect_delay",6e4);this.options.reconnect=s(this.get_option("reconnect_limit"),a(c,p))}else if("number"==typeof i){var l=this.options.reconnect;this.options.reconnect=s(this.get_option("reconnect_limit"),function(){return l})}this.registered=!1,this.state=new g,this.local_channel_map={},this.remote_channel_map={},this.local={},this.remote={},this.local.open=_.open(this.options),this.local.close=_.close({}),this.session_policy=o(this),this.amqp_transport=new b(this.options.id,S,_.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.conn_established_counter=0,this.heartbeat_out=void 0,this.heartbeat_in=void 0,this.abort_idle=!1,this.socket_ready=!1,this.scheduled_reconnect=void 0,this.default_sender=void 0;for(var f in k){var d=k[f];Object.defineProperty(this,d,{get:h(d)})}Object.defineProperty(this,"error",{get:function(){return this.remote.close?this.remote.close.error:void 0}})};P.prototype=Object.create(A.prototype),P.prototype.constructor=P,P.prototype.dispatch=function(t){return m.events("Connection got event: %s",t),this.listeners(t).length?(A.prototype.emit.apply(this,arguments),!0):!!this.container&&this.container.dispatch.apply(this.container,arguments)},P.prototype.reset=function(){this.abort_idle&&(this.abort_idle=!1,this.local.close.error=void 0,this.state=new g,this.state.open()),this.amqp_transport=new b(this.options.id,S,_.TYPE_AMQP,this),this.sasl_transport=void 0,this.transport=this.amqp_transport,this.state.disconnected(),this.remote={},this.remote_channel_map={};for(var t in this.local_channel_map)this.local_channel_map[t].reset();this.socket_ready=!1},P.prototype.connect=function(){return this.is_server=!1,this._connect(this.options.connection_details(this.conn_established_counter)),this.open(),this},P.prototype.reconnect=function(){return this.scheduled_reconnect=void 0,m.reconnect("reconnecting..."),this.reset(),this._connect(this.options.connection_details(this.conn_established_counter)),e.nextTick(this._process.bind(this)),this},P.prototype._connect=function(t){return t.connect?this.init(t.connect(t.port,t.host,t.options,this.connected.bind(this))):this.init(c(t)(t.port,t.host,t.options,this.connected.bind(this))),this},P.prototype.accept=function(t){return this.is_server=!0,m.io("[%s] client accepted: %s",this.id,i(t)),this.socket_ready=!0,this.init(t)},P.prototype.init=function(t){if(this.socket=t,this.get_option("tcp_no_delay",!1)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.socket.on("data",this.input.bind(this)),this.socket.on("error",this.on_error.bind(this)),this.socket.on("end",this.eof.bind(this)),this.is_server){var e;if(this.container&&Object.getOwnPropertyNames(this.container.sasl_server_mechanisms).length&&(e=this.container.sasl_server_mechanisms),this.socket.encrypted&&this.socket.authorized&&this.get_option("enable_sasl_external",!1)&&(e=y.server_add_external(e?v.clone(e):{})),e)void 0===e.ANONYMOUS||this.get_option("require_sasl",!1)?this.sasl_transport=new y.Server(this,e):this.sasl_transport=new y.Selective(this,e);else if(!this.get_option("disable_sasl",!1)){var r=y.server_mechanisms();r.enable_anonymous(),this.sasl_transport=new y.Selective(this,r)}}else{var n=this.get_option("sasl_mechanisms");if(!n){var i=this.get_option("username"),o=this.get_option("password");i&&(n=y.client_mechanisms(),o?n.enable_plain(i,o):n.enable_anonymous(i))}this.socket.encrypted&&this.options.cert&&this.get_option("enable_sasl_external",!1)&&(n||(n=y.client_mechanisms()),n.enable_external()),n&&(this.sasl_transport=new y.Client(this,n,this.options.sasl_init_hostname||this.options.servername||this.options.host))}return this.transport=this.sasl_transport?this.sasl_transport:this.amqp_transport,this},P.prototype.attach_sender=function(t){return this.session_policy.get_session().attach_sender(t)},P.prototype.open_sender=P.prototype.attach_sender,P.prototype.attach_receiver=function(t){return this.get_option("tcp_no_delay",!0)&&this.socket.setNoDelay&&this.socket.setNoDelay(!0),this.session_policy.get_session().attach_receiver(t)},P.prototype.open_receiver=P.prototype.attach_receiver,P.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.container?this.container.get_option(t,e):e},P.prototype.send=function(t){return void 0===this.default_sender&&(this.default_sender=this.open_sender({target:{}})),this.default_sender.send(t)},P.prototype.connected=function(){this.socket_ready=!0,this.conn_established_counter++,m.io("[%s] connected %s",this.options.id,i(this.socket)),this.output()},P.prototype.sasl_failed=function(t){this.transport_error={condition:"amqp:unauthorized-access",description:t},this._handle_error()},P.prototype._is_fatal=function(t){var e=this.get_option("non_fatal_errors",["amqp:connection:forced"]);return e.indexOf(t)<0},P.prototype._handle_error=function(){var t=this.get_error();if(t){var e=this.dispatch("connection_error",this._context());return e=this.dispatch("connection_close",this._context())||e,this._is_fatal(t.condition)?e||this.dispatch("error",new d.ConnectionError(t.description,t.condition,this)):this.open(),!0}return!1},P.prototype.get_error=function(){return this.transport_error?this.transport_error:this.remote.close&&this.remote.close.error?this.remote.close.error:void 0},P.prototype._get_peer_details=function(){var t="";return this.remote.open&&this.remote.open.container&&(t+=this.remote.open.container+" "),this.remote.open&&this.remote.open.properties&&(t+=JSON.stringify(this.remote.open.properties)),t},P.prototype.output=function(){try{this.socket&&this.socket_ready&&(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.transport.write(this.socket),(this.is_closed()&&this.state.has_settled()||this.abort_idle||this.transport_error)&&!this.transport.has_writes_pending()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2)))}catch(t){"ProtocolError"===t.name?(console.error("["+this.options.id+"] error on write: "+t+" "+this._get_peer_details()+" "+t.name),this.dispatch("protocol_error",t)||console.error("["+this.options.id+"] error on write: "+t+" "+this._get_peer_details())):this.dispatch("error",t),this.socket.end()}},P.prototype.input=function(t){var e;try{this.heartbeat_in&&clearTimeout(this.heartbeat_in),m.io("[%s] read %d bytes",this.options.id,t.length),this.previous_input?(e=n.concat([this.previous_input,t],this.previous_input.length+t.length),this.previous_input=null):e=t;var r=this.transport.read(e,this);r<e.length&&(this.previous_input=e.slice(r)),this.local.open.idle_time_out&&(this.heartbeat_in=setTimeout(this.idle.bind(this),this.local.open.idle_time_out)),this.transport.has_writes_pending()?this.output():this.is_closed()&&this.state.has_settled()?this.socket.end():this.is_open()&&this.remote.open.idle_time_out&&!this.heartbeat_out&&(this.heartbeat_out=setTimeout(this._write_frame.bind(this),this.remote.open.idle_time_out/2))}catch(t){"ProtocolError"===t.name?this.dispatch("protocol_error",t)||console.error("["+this.options.id+"] error on read: "+t+" "+this._get_peer_details()+" (buffer:"+l(e)+")"):this.dispatch("error",t),this.socket.end()}},P.prototype.idle=function(){this.is_open()&&(this.abort_idle=!0,this.local.close.error={condition:"amqp:resource-limit-exceeded",description:"max idle time exceeded"},this.close())},P.prototype.on_error=function(t){console.warn("["+this.options.id+"] error: "+t),this._disconnected()},P.prototype.eof=function(){this._disconnected()},P.prototype._disconnected=function(){if(this.heartbeat_out&&clearTimeout(this.heartbeat_out),this.heartbeat_in&&clearTimeout(this.heartbeat_in),!this.is_closed()&&void 0===this.scheduled_reconnect&&(this.dispatch("disconnected",this._context())||console.warn("["+this.options.id+"] disconnected "),!this.is_server&&!this.transport_error&&this.options.reconnect)){var t=this.options.reconnect(this.conn_established_counter);t>=0&&(m.reconnect("Scheduled reconnect in "+t+"ms"),this.scheduled_reconnect=setTimeout(this.reconnect.bind(this),t))}},P.prototype.open=function(){this.state.open()&&this._register()},P.prototype.close=function(t){t&&(this.local.close.error=t),this.state.close()&&this._register()},P.prototype.is_open=function(){return this.state.is_open()},P.prototype.is_closed=function(){return this.state.is_closed()},P.prototype.create_session=function(){for(var t=0;this.local_channel_map[t];)t++;var e=new w(this,t);return this.local_channel_map[t]=e,e},P.prototype.find_sender=function(t){return this.find_link(v.sender_filter(t))},P.prototype.find_receiver=function(t){return this.find_link(v.receiver_filter(t))},P.prototype.find_link=function(t){for(var e in this.local_channel_map){var r=this.local_channel_map[e],n=r.find_link(t);if(n)return n}},P.prototype.each_receiver=function(t,e){this.each_link(t,v.receiver_filter(e))},P.prototype.each_sender=function(t,e){this.each_link(t,v.sender_filter(e))},P.prototype.each_link=function(t,e){for(var r in this.local_channel_map){var n=this.local_channel_map[r];n.each_link(t,e)}},P.prototype.on_open=function(t){if(!this.state.remote_opened())throw new d.ProtocolError("Open already received");this.remote.open=t.performative,this.open(),this.dispatch("connection_open",this._context())},P.prototype.on_close=function(t){if(!this.state.remote_closed())throw new d.ProtocolError("Close already received");this.remote.close=t.performative,this.close(),this.remote.close.error?this._handle_error():this.dispatch("connection_close",this._context()),this.heartbeat_out&&clearTimeout(this.heartbeat_out)},P.prototype._register=function(){this.registered||(this.registered=!0,e.nextTick(this._process.bind(this)))},P.prototype._process=function(){this.registered=!1;do{this.state.need_open()&&this._write_open();for(var t in this.local_channel_map)this.local_channel_map[t]._process();this.state.need_close()&&this._write_close()}while(!this.state.has_settled())},P.prototype._write_frame=function(t,e,r){this.amqp_transport.encode(_.amqp_frame(t,e,r)),this.output()},P.prototype._write_open=function(){this._write_frame(0,this.local.open.described())},P.prototype._write_close=function(){this._write_frame(0,this.local.close.described())},P.prototype.on_begin=function(t){var e;if(null===t.performative.remote_channel||void 0===t.performative.remote_channel)e=this.create_session(),e.local.begin.remote_channel=t.channel;else if(e=this.local_channel_map[t.performative.remote_channel],!e)throw new d.ProtocolError("Invalid value for remote channel "+t.performative.remote_channel);e.on_begin(t),this.remote_channel_map[t.channel]=e},P.prototype.get_peer_certificate=function(){return this.socket&&this.socket.getPeerCertificate?this.socket.getPeerCertificate():void 0},P.prototype.get_tls_socket=function(){return!this.socket||"tls"!==this.options.transport&&"ssl"!==this.options.transport?void 0:this.socket},P.prototype._context=function(t){var e=t?t:{};return e.connection=this,this.container&&(e.container=this.container),e},f("end"),f("attach"),f("detach"),f("transfer"),f("disposition"),f("flow"),t.exports=P}).call(e,r(7),r(1).Buffer)},function(t,e,r){(function(e){"use strict";var n=r(27),i=r(3),o=r(31),s=r(13),a=r(11),c=r(8),u=r(15),h=r(6).EventEmitter,p=function(t){this.options=t?Object.create(t):{},this.options.id||(this.options.id=a.generate_uuid()),this.id=this.options.id,this.sasl_server_mechanisms=s.server_mechanisms()};p.prototype=Object.create(h.prototype),p.prototype.constructor=p,p.prototype.dispatch=function(t){return i.events("Container got event: "+t),h.prototype.emit.apply(this,arguments),!!this.listeners(t).length},p.prototype.connect=function(t){return new n(t,this).connect()},p.prototype.listen=function(t){var r,i=this;if(void 0===t.transport||"tcp"===t.transport)r=c.createServer(),r.on("connection",function(e){new n(t,i).accept(e)});else{if("tls"!==t.transport&&"ssl"!==t.transport)throw Error("Unrecognised transport: "+t.transport);r=u.createServer(t),r.on("secureConnection",function(e){new n(t,i).accept(e)})}return e.version.match(/v0\.10\.\d+/)?r.listen(t.port,t.host):r.listen(t),r},p.prototype.create_container=function(t){
return new p(t)},p.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:e},p.prototype.generate_uuid=a.generate_uuid,p.prototype.rpc_server=function(t,e){return o.server(this,t,e)},p.prototype.rpc_client=function(t){return o.client(this,t)};var l=r(34);p.prototype.websocket_accept=function(t,e){new n(e,this).accept(l.wrap(t))},p.prototype.websocket_connect=l.connect,p.prototype.filter=r(29),p.prototype.types=r(4),p.prototype.message=r(10),t.exports=new p}).call(e,r(7))},function(t,e,r){"use strict";var n=r(4);t.exports={selector:function(t){return{"jms-selector":n.wrap_described(t,77567109365764)}}}},function(t,e,r){(function(e){"use strict";function n(t){t.delivery.settled=!0}function i(t){t.delivery.update(void 0,h.accepted().described())}function o(t,e,r){Error.call(this),Error.captureStackTrace(this,this.constructor),this.message=t,this.condition=e,this.description=t,this.link=r}function s(t){switch(t){case"name":case"handle":case"role":case"initial_delivery_count":return!0;default:return!1}}function a(t){return function(){return this.remote.attach?this.remote.attach[t]:void 0}}var c=r(5),u=r(3),h=r(10),p=r(33),l=r(9),f=function(t){this.window=t};f.prototype.update=function(t){var e=this.window-t.receiver.credit;e>=this.window/4&&t.receiver.flow(e)},r(16).inherits(o,Error);var d=r(6).EventEmitter,_=Object.create(d.prototype);_.dispatch=function(t){return u.events("Link got event: %s",t),d.prototype.emit.apply(this.observers,arguments),this.listeners(t).length?(d.prototype.emit.apply(this,arguments),!0):this.session.dispatch.apply(this.session,arguments)},_.set_source=function(t){this.local.attach.source=p.source(t).described()},_.set_target=function(t){this.local.attach.target=p.target(t).described()},_.attach=function(){this.state.open()&&this.connection._register()},_.open=_.attach,_.detach=function(){this.local.detach.closed=!1,this.state.close()&&this.connection._register()},_.close=function(t){t&&(this.local.detach.error=t),this.local.detach.closed=!0,this.state.close()&&this.connection._register()},_.is_open=function(){return this.session.is_open()&&this.state.is_open()},_.is_closed=function(){return this.session.is_closed()||this.state.is_closed()},_._process=function(){do this.state.need_open()&&this.session.output(this.local.attach.described()),this.issue_flow&&(this.session._write_flow(this),this.issue_flow=!1),this.state.need_close()&&this.session.output(this.local.detach.described());while(!this.state.has_settled())},_.on_attach=function(t){if(!this.state.remote_opened())throw Error("Attach already received");this.remote.handle||(this.remote.handle=t.handle),t.performative.source=p.unwrap(t.performative.source),t.performative.target=p.unwrap(t.performative.target),this.remote.attach=t.performative,this.open(),this.dispatch(this.is_receiver()?"receiver_open":"sender_open",this._context())},_.prefix_event=function(t){return(this.local.attach.role?"receiver_":"sender_")+t},_.on_detach=function(t){if(!this.state.remote_closed())throw Error("Detach already received");this.remote.detach=t.performative,this.close();var e=this.remote.detach.error;if(e){var r=this.dispatch(this.prefix_event("error"),this._context());r=this.dispatch(this.prefix_event("close"),this._context())||r,r||d.prototype.emit.call(this.connection.container,"error",new o(e.description,e.condition,this))}else this.dispatch(this.prefix_event("close"),this._context())};var m=["snd_settle_mode","rcv_settle_mode","source","target","max_message_size","offered_capabilities","desired_capabilities","properties"];_.init=function(t,e,r,n,i){this.session=t,this.connection=t.connection,this.name=e,this.options=void 0===n?{}:n,this.state=new l,this.issue_flow=!1,this.local={handle:r},this.local.attach=c.attach({handle:r,name:e,role:i});for(var o in this.local.attach)s(o)||void 0===this.options[o]||(this.local.attach[o]=this.options[o]);this.local.detach=c.detach({handle:r,closed:!0}),this.remote={handle:void 0},this.delivery_count=0,this.credit=0,this.observers=new d;for(var u in m){var h=m[u];Object.defineProperty(this,h,{get:a(h)})}Object.defineProperty(this,"error",{get:function(){return this.remote.detach?this.remote.detach.error:void 0}})},_.reset=function(){this.state.disconnected(),this.remote={handle:void 0},this.delivery_count=0,this.credit=0},_.has_credit=function(){return this.credit>0},_.is_receiver=function(){return this.local.attach.role},_.is_sender=function(){return!this.is_receiver()},_._context=function(t){var e=t?t:{};return this.is_receiver()?e.receiver=this:e.sender=this,this.session._context(e)},_.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.session.get_option(t,e)};var y=function(t,e,r,i){this.init(t,e,r,i,!1),this._draining=!1,this._drained=!1,this.local.attach.initial_delivery_count=0,this.tag=0,this.get_option("autosettle",!0)&&this.observers.on("settled",n);var o=this;this.get_option("treat_modified_as_released",!0)&&this.observers.on("modified",function(t){o.dispatch("released",t)})};y.prototype=Object.create(_),y.prototype.constructor=y,y.prototype._get_drain=function(){if(this._draining&&this._drained&&this.credit){for(;this.credit;)++this.delivery_count,--this.credit;return!0}return!1},y.prototype.set_drained=function(t){this._drained=t,this._draining&&this._drained&&(this.issue_flow=!0)},y.prototype.next_tag=function(){return new e(new String(this.tag++))},y.prototype.sendable=function(){return this.credit&&this.session.outgoing.available()},y.prototype.on_flow=function(t){var e=t.performative;this.credit=e.delivery_count+e.link_credit-this.delivery_count,this._draining=e.drain,this._drained=this.credit>0,this.is_open()&&(this.dispatch("sender_flow",this._context()),this._draining&&this.dispatch("sender_draining",this._context()),this.sendable()&&this.dispatch("sendable",this._context()))},y.prototype.on_transfer=function(){throw Error("got transfer on sending link")},y.prototype.send=function(t,e){var r=this.session.send(this,e?e:this.next_tag(),h.encode(t),0);return 1===this.local.attach.snd_settle_mode&&(r.settled=!0),r};var v=function(t,e,r,n){this.init(t,e,r,n,!0),this.drain=!1,this.set_credit_window(this.get_option("credit_window",1e3)),this.get_option("autoaccept",!0)&&this.observers.on("message",i)};v.prototype=Object.create(_),v.prototype.constructor=v,v.prototype.on_flow=function(t){this.dispatch("receiver_flow",this._context()),t.performative.drain&&(t.performative.link_credit>0?console.error("ERROR: received flow with drain set, but non zero credit"):this.dispatch("receiver_drained",this._context()))},v.prototype.flow=function(t){t>0&&(this.credit+=t,this.issue_flow=!0,this.connection._register())},v.prototype.add_credit=v.prototype.flow,v.prototype._get_drain=function(){return this.drain},v.prototype.set_credit_window=function(t){if(t>0){var e=new f(t),r=e.update.bind(e);this.observers.on("message",r),this.observers.on("receiver_open",r)}},t.exports={Sender:y,Receiver:v}}).call(e,r(1).Buffer)},function(t,e,r){"use strict";function n(t,e){return!!e&&(Array.isArray(e)?e.indexOf(t)>-1:t===e)}var i=r(36),o={counter:1,next:function(){return this.counter++}},s=function(t,e){var r=i.parse(e);this.connection=t.connect({host:r.hostname,port:r.port}),this.connection.on("message",this._response.bind(this)),this.connection.on("receiver_open",this._ready.bind(this)),this.sender=this.connection.attach_sender(r.path.substr(1)),this.receiver=this.connection.attach_receiver({source:{dynamic:!0}}),this.id_generator=o,this.pending=[],this.outstanding={}};s.prototype._request=function(t,e,r,n){var i={};i.subject=e,i.body=r,i.message_id=t,i.reply_to=this.receiver.remote.attach.source.address,this.outstanding[t]=n,this.sender.send(i)},s.prototype._response=function(t){var e=t.message.correlation_id,r=this.outstanding[e];r?"ok"===t.message.subject?r(t.message.body):r(void 0,{name:t.message.subject,description:t.message.body}):console.error("no request pending for "+e+", ignoring response")},s.prototype._ready=function(){this._process_pending()},s.prototype._process_pending=function(){for(var t=0;t<this.pending.length;t++){var e=this.pending[t];this._request(e.id,e.name,e.args,e.callback)}this.pending=[]},s.prototype.call=function(t,e,r){var n=this.id_generator.next();this.receiver.is_open()&&0===this.pending.length?this._request(n,t,e,r):this.pending.push({name:t,args:e,callback:r,id:n})},s.prototype.close=function(){this.receiver.close(),this.sender.close(),this.connection.close()},s.prototype.define=function(t){this[t]=function(e,r){this.call(t,e,r)}};var a=function(t,e){this.ttl=t,this.purged=e,this.entries={},this.timeout=void 0};a.prototype.clear=function(){this.timeout&&clearTimeout(this.timeout),this.entries={}},a.prototype.put=function(t,e){this.entries[t]={value:e,last_accessed:Date.now()},this.timeout||(this.timeout=setTimeout(this.purge.bind(this),this.ttl))},a.prototype.get=function(t){var e=this.entries[t];return e?(e.last_accessed=Date.now(),e.value):void 0},a.prototype.purge=function(){var t=Date.now(),e=[],r=0;for(var n in this.entries)t-this.entries[n].last_accessed>=this.ttl?e.push(n):r++;for(var i=0;i<e.length;i++){var o=this.entries[e[i]];delete this.entries[e[i]],this.purged(o.value)}r&&!this.timeout&&(this.timeout=setTimeout(this.purge.bind(this),this.ttl))};var c=function(t,e){this.factory=t,this.cache=new a(e,function(t){t.close()})};c.prototype.clear=function(){this.cache.clear()},c.prototype.get=function(t){var e=this.cache.get(t);return void 0===e&&(e=this.factory(t),this.cache.put(t,e)),e};var u=function(t,e,r){this.options=r||{};var n=i.parse(e);this.connection=t.connect({host:n.hostname,port:n.port}),this.connection.on("connection_open",this._connection_open.bind(this)),this.connection.on("message",this._request.bind(this)),this.receiver=this.connection.attach_receiver(n.path.substr(1)),this.callbacks={},this._send=void 0,this._clear=void 0};u.prototype._connection_open=function(){if(n("ANONYMOUS-RELAY",this.connection.remote.open.offered_capabilities)){var t=this.connection.attach_sender({target:{}});this._send=function(e){t.send(e)}}else{var e=new c(this.connection.attach_sender.bind(this.connection),this.options.cache_ttl||6e4);this._send=function(t){var r=e.get(t.to);r&&r.send(t)},this._clear=function(){e.clear()}}},u.prototype._respond=function(t){var e=this;return function(r,n){n?(t.subject=n.name||"error",t.body=n.description||n):(t.subject="ok",t.body=r),e._send(t)}},u.prototype._request=function(t){var e=t.message,r={};r.to=e.reply_to,r.correlation_id=e.message_id;var n=this.callbacks[e.subject];n?n(e.body,this._respond(r)):(r.subject="bad-method",r.body="Unrecognised method "+e.subject,this._send(r))},u.prototype.bind_sync=function(t,e){this.callbacks[e||t.name]=function(e,r){var n=t(e);r(n)}},u.prototype.bind=function(t,e){this.callbacks[e||t.name]=t},u.prototype.close=function(){this._clear&&this._clear(),this.receiver.close(),this.connection.close()},t.exports={server:function(t,e,r){return new u(t,e,r)},client:function(t,e){return new s(t,e)}}},function(t,e,r){(function(e){"use strict";function n(t){var e,r,n,i,s;for(i=0;i<t.length;i++)s=t[i],void 0===e&&(e=s,r=s,n=s.id),c.are_outcomes_equivalent(r.state,s.state)&&r.settled===s.settled&&n===s.id?(r.id!==s.id&&(r=s),n++):(e.link.session.output(o.disposition({role:e.link.is_receiver(),first:e.id,last:r.id,state:e.state,settled:e.settled}).described()),e=s,r=s,n=s.id);void 0!==e&&void 0!==r&&e.link.session.output(o.disposition({role:e.link.is_receiver(),first:e.id,last:r.id,state:e.state,settled:e.settled}).described())}function i(t,e,r){var n=e?e:{};"string"==typeof e&&(n={},n[r]=e),n.name||(n.name=h.generate_uuid());var i=t(n.name,n);for(var o in{source:0,target:0})n[o]&&("string"==typeof n[o]&&(n[o]={address:n[o]}),i["set_"+o](n[o]));return i.is_sender()&&void 0===n.source&&(n.source=i.set_source({})),i.is_receiver()&&void 0===n.target&&(n.target=i.set_target({})),i.attach(),i}var o=r(5),s=r(30),a=r(3),c=r(10),u=r(4),h=r(11),p=r(9),l=r(6).EventEmitter,f=function(t){this.capacity=t,this.size=0,this.head=0,this.tail=0,this.entries=[]};f.prototype.available=function(){return this.capacity-this.size},f.prototype.push=function(t){if(!(this.size<this.capacity))throw Error("circular buffer overflow: head="+this.head+" tail="+this.tail+" size="+this.size+" capacity="+this.capacity);this.entries[this.tail]=t,this.tail=(this.tail+1)%this.capacity,this.size++},f.prototype.pop_if=function(t){for(var e=0;this.size&&t(this.entries[this.head]);)this.entries[this.head]=void 0,this.head=(this.head+1)%this.capacity,this.size--,e++;return e},f.prototype.by_id=function(t){if(this.size>0){var e=t-this.entries[this.head].id;if(e<this.size)return this.entries[(this.head+e)%this.capacity]}},f.prototype.get_head=function(){return this.size>0?this.entries[this.head]:void 0},f.prototype.get_tail=function(){return this.size>0?this.entries[(this.head+this.size-1)%this.capacity]:void 0};var d=function(t){this.deliveries=new f(2048),this.updated=[],this.pending_dispositions=[],this.next_delivery_id=0,this.next_pending_delivery=0,this.next_transfer_id=0,this.window=u.MAX_UINT,this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.connection=t};d.prototype.available=function(){return this.deliveries.available()},d.prototype.compute_max_payload=function(t){return this.connection.max_frame_size?this.connection.max_frame_size-(50+t.length):void 0},d.prototype.send=function(t,e,r,n){var i=[],o=this.compute_max_payload(e);if(o&&r.length>o)for(var s=0;s<r.length;){var a=Math.min(s+o,r.length);i.push(r.slice(s,a)),s=a}else i.push(r);var c={id:this.next_delivery_id++,tag:e,link:t,data:i,format:n?n:0,sent:!1,settled:!1,state:void 0,remote_settled:!1,remote_state:void 0},u=this;return c.update=function(t,e){u.update(c,t,e)},this.deliveries.push(c),c},d.prototype.on_begin=function(t){this.remote_window=t.incoming_window},d.prototype.on_flow=function(t){this.remote_next_transfer_id=t.next_incoming_id,this.remote_window=t.incoming_window},d.prototype.on_disposition=function(t){for(var e=t.last?t.last:t.first,r=t.first;r<=e;r++){var n=this.deliveries.by_id(r);if(n&&!n.remote_settled){var i=!1;t.settled&&(n.remote_settled=t.settled,i=!0),t.state&&t.state!==n.remote_state&&(n.remote_state=c.unwrap_outcome(t.state),i=!0),i&&this.updated.push(n)}}},d.prototype.update=function(t,e,r){t&&(t.settled=e,void 0!==r&&(t.state=r),t.remote_settled||this.pending_dispositions.push(t),t.link.connection._register())},d.prototype.transfer_window=function(){return this.remote_window?this.remote_window-(this.next_transfer_id-this.remote_next_transfer_id):0},d.prototype.process=function(){for(var t;this.next_pending_delivery<this.next_delivery_id;){if(t=this.deliveries.by_id(this.next_pending_delivery),!t){console.error("ERROR: Next pending delivery not found: "+this.next_pending_delivery);break}if(!t.link.has_credit()){a.flow("Link has no credit");break}if(!(this.transfer_window()>=t.data.length)){a.flow("Incoming window of peer preventing sending further transfers: remote_window=%d, remote_next_transfer_id=%d, next_transfer_id=%d",this.remote_window,this.remote_next_transfer_id,this.next_transfer_id);break}this.window-=t.data.length;for(var e=0;e<t.data.length;e++){this.next_transfer_id++;var r=e+1<t.data.length,i=o.transfer({handle:t.link.local.handle,message_format:t.format,delivery_id:t.id,delivery_tag:t.tag,settled:t.settled,more:r});t.link.session.output(i.described(),t.data[e])}t.link.credit--,t.link.delivery_count++,this.next_pending_delivery++}for(var e=0;e<this.updated.length;e++)t=this.updated[e],t.remote_state&&t.remote_state.constructor.composite_type&&t.link.dispatch(t.remote_state.constructor.composite_type,t.link._context({delivery:t})),t.remote_settled&&t.link.dispatch("settled",t.link._context({delivery:t}));this.updated=[],this.pending_dispositions.length&&(n(this.pending_dispositions),this.pending_dispositions=[]),this.deliveries.pop_if(function(t){return t.settled&&t.remote_settled})};var _=function(){this.deliveries=new f(2048),this.updated=[],this.next_transfer_id=0,this.next_delivery_id=void 0,Object.defineProperty(this,"window",{get:function(){return this.deliveries.available()}}),this.remote_next_transfer_id=void 0,this.remote_window=void 0,this.max_transfer_id=this.next_transfer_id+this.window};_.prototype.update=function(t,e,r){t&&(t.settled=e,void 0!==r&&(t.state=r),t.remote_settled||this.updated.push(t),t.link.connection._register())},_.prototype.on_transfer=function(t,r){if(this.next_transfer_id++,r.is_open()){void 0===this.next_delivery_id&&(this.next_delivery_id=t.performative.delivery_id);var n,i,o=this.deliveries.get_tail();if(o&&o.incomplete){if(void 0!==t.performative.delivery_id&&this.next_delivery_id!==t.performative.delivery_id)throw Error("frame sequence error: delivery "+this.next_delivery_id+" not complete, got "+t.performative.delivery_id);n=o,i=e.concat([n.data,t.payload],n.data.length+t.payload.length)}else{if(this.next_delivery_id!==t.performative.delivery_id)throw Error("frame sequence error: expected "+this.next_delivery_id+", got "+t.performative.delivery_id);n={id:t.performative.delivery_id,tag:t.performative.delivery_tag,link:r,settled:!1,state:void 0,remote_settled:void 0!==t.performative.settled&&t.performative.settled,remote_state:t.performative.state};var s=this;n.update=function(t,e){var i=t;void 0===i&&(i=1!==r.local.attach.rcv_settle_mode),s.update(n,i,e)},n.accept=function(){this.update(void 0,c.accepted().described())},n.release=function(t){t?this.update(void 0,c.modified(t).described()):this.update(void 0,c.released().described())},n.reject=function(t){this.update(!0,c.rejected({error:t}).described())},n.modified=function(t){this.update(!0,c.modified(t).described())},this.deliveries.push(n),i=t.payload}n.incomplete=t.performative.more,n.incomplete?n.data=i:(r.credit--,r.delivery_count++,this.next_delivery_id++,r.dispatch("message",r._context({message:c.decode(i),delivery:n})))}},_.prototype.process=function(t){this.updated.length>0&&(n(this.updated),this.updated=[]),this.deliveries.pop_if(function(t){return t.settled}),this.max_transfer_id-this.next_transfer_id<this.window/2&&t._write_flow()},_.prototype.on_begin=function(t){this.remote_window=t.outgoing_window,this.remote_next_transfer_id=t.next_outgoing_id},_.prototype.on_flow=function(t){this.remote_next_transfer_id=t.next_outgoing_id,this.remote_window=t.outgoing_window},_.prototype.on_disposition=function(t){for(var e=t.last?t.last:t.first,r=t.first;r<=e;r++){var n=this.deliveries.by_id(r);n&&!n.remote_settled&&t.settled&&(n.remote_settled=t.settled,n.link.dispatch("settled",n.link._context({delivery:n})))}};var m=function(t,e){this.connection=t,this.outgoing=new d(t),this.incoming=new _,this.state=new p,this.local={channel:e,handles:{}},this.local.begin=o.begin({next_outgoing_id:this.outgoing.next_transfer_id,incoming_window:this.incoming.window,outgoing_window:this.outgoing.window}),this.local.end=o.end(),this.remote={handles:{}},this.links={},this.options={}};m.prototype=Object.create(l.prototype),m.prototype.constructor=m,m.prototype.reset=function(){this.state.disconnected(),this.outgoing=new d(this.connection),this.incoming=new _,this.remote={handles:{}};for(var t in this.links)this.links[t].reset()},m.prototype.dispatch=function(t){return a.events("Session got event: %s",t),this.listeners(t).length?(l.prototype.emit.apply(this,arguments),!0):this.connection.dispatch.apply(this.connection,arguments)},m.prototype.output=function(t,e){this.connection._write_frame(this.local.channel,t,e)},m.prototype.create_sender=function(t,e){return this.create_link(t,s.Sender,e)},m.prototype.create_receiver=function(t,e){return this.create_link(t,s.Receiver,e)},m.prototype.get_option=function(t,e){return void 0!==this.options[t]?this.options[t]:this.connection.get_option(t,e)},m.prototype.attach_sender=function(t){return i(this.create_sender.bind(this),t,"target")},m.prototype.open_sender=m.prototype.attach_sender,m.prototype.attach_receiver=function(t){return i(this.create_receiver.bind(this),t,"source")},m.prototype.open_receiver=m.prototype.attach_receiver,m.prototype.find_sender=function(t){return this.find_link(h.sender_filter(t))},m.prototype.find_receiver=function(t){return this.find_link(h.receiver_filter(t))},m.prototype.find_link=function(t){for(var e in this.links){var r=this.links[e];if(t(r))return r}},m.prototype.each_receiver=function(t,e){this.each_link(h.receiver_filter(e))},m.prototype.each_sender=function(t,e){this.each_link(h.sender_filter(e))},m.prototype.each_link=function(t,e){for(var r in this.links){var n=this.links[r];(void 0===e||e(n))&&t(n)}},m.prototype.create_link=function(t,e,r){for(var n=0;this.local.handles[n];)n++;var i=new e(this,t,n,r);return this.links[t]=i,this.local.handles[n]=i,i},m.prototype.begin=function(){this.state.open()&&this.connection._register()},m.prototype.open=m.prototype.begin,m.prototype.end=function(t){t&&(this.local.end.error=t),this.state.close()&&this.connection._register()},m.prototype.close=m.prototype.end,m.prototype.is_open=function(){return this.connection.is_open()&&this.state.is_open()},m.prototype.is_closed=function(){return this.connection.is_closed()||this.state.is_closed()},m.prototype._process=function(){do{this.state.need_open()&&this.output(this.local.begin.described()),this.outgoing.process(),this.incoming.process(this);for(var t in this.links)this.links[t]._process();this.state.need_close()&&this.output(this.local.end.described())}while(!this.state.has_settled())},m.prototype.send=function(t,e,r,n){var i=this.outgoing.send(t,e,r,n);return this.connection._register(),i},m.prototype._write_flow=function(t){var e={next_incoming_id:this.incoming.next_transfer_id,incoming_window:this.incoming.window,next_outgoing_id:this.outgoing.next_transfer_id,outgoing_window:this.outgoing.window};this.incoming.max_transfer_id=e.next_incoming_id+e.incoming_window,t&&(t._get_drain()&&(e.drain=!0),e.delivery_count=t.delivery_count,e.handle=t.local.handle,e.link_credit=t.credit),this.output(o.flow(e).described())},m.prototype.on_begin=function(t){if(!this.state.remote_opened())throw Error("Begin already received");this.remote.channel||(this.remote.channel=t.channel),this.remote.begin=t.performative,this.outgoing.on_begin(t.performative),this.incoming.on_begin(t.performative),this.open(),this.dispatch("session_open",this._context())},m.prototype.on_end=function(t){if(!this.state.remote_closed())throw Error("End already received");this.remote.end=t.performative,this.close(),this.dispatch("session_close",this._context())},m.prototype.on_attach=function(t){var e=t.performative.name,r=this.links[e];r||(r=t.performative.role?this.create_sender(e):this.create_receiver(e)),this.remote.handles[t.performative.handle]=r,r.on_attach(t),r.remote.attach=t.performative},m.prototype.on_disposition=function(t){t.performative.role?(a.events("Received disposition for outgoing transfers"),this.outgoing.on_disposition(t.performative)):(a.events("Received disposition for incoming transfers"),this.incoming.on_disposition(t.performative)),this.connection._register()},m.prototype.on_flow=function(t){this.outgoing.on_flow(t.performative),this.incoming.on_flow(t.performative),void 0!==t.performative.handle&&this._get_link(t).on_flow(t),this.connection._register()},m.prototype._context=function(t){var e=t?t:{};return e.session=this,this.connection._context(e)},m.prototype._get_link=function(t){var e=t.performative.handle,r=this.remote.handles[e];if(!r)throw Error("Invalid handle "+e);return r},m.prototype.on_detach=function(t){this._get_link(t).on_detach(t);var e=t.performative.handle,r=this.remote.handles[e];delete this.remote.handles[e],delete this.local.handles[r.local.handle],delete this.links[r.name]},m.prototype.on_transfer=function(t){this.incoming.on_transfer(t,this._get_link(t))},t.exports=m}).call(e,r(1).Buffer)},function(t,e,r){"use strict";function n(t){var e=i.define_composite(t);o[t.name]=e.create,s[Number(e.descriptor.numeric).toString(10)]=e,s[e.descriptor.symbolic]=e}var i=r(4),o={},s={};o.unwrap=function(t){if(t&&t.descriptor){var e=s[t.descriptor.value];if(e)return new e(t.value);console.warn("Unknown terminus: "+t.descriptor)}return null},n({name:"source",code:40,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"distribution_mode",type:"symbol"},{name:"filter",type:"symbolic_map"},{name:"default_outcome",type:"*"},{name:"outcomes",type:"symbol",multiple:!0},{name:"capabilities",type:"symbol",multiple:!0}]}),n({name:"target",code:41,fields:[{name:"address",type:"string"},{name:"durable",type:"uint",default_value:0},{name:"expiry_policy",type:"symbol",default_value:"session-end"},{name:"timeout",type:"uint",default_value:0},{name:"dynamic",type:"boolean",default_value:!1},{name:"dynamic_node_properties",type:"symbolic_map"},{name:"capabilities",type:"symbol",multiple:!0}]}),t.exports=o},function(t,e,r){(function(e){"use strict";function r(t){return t}function n(t){return new e(t instanceof ArrayBuffer?new Uint8Array(t):t)}function i(t){return new Uint8Array(t)}function o(t){var e=r,o=r;return t.binaryType&&(t.binaryType="arraybuffer",e=n,o=i),{end:function(){t.close()},write:function(e){try{t.send(o(e),{binary:!0})}catch(e){t.onerror(e)}},on:function(r,n){"data"===r?t.onmessage=function(t){n(e(t.data))}:"end"===r?t.onclose=n:"error"===r?t.onerror=n:console.error("ERROR: Attempt to set unrecognised handler on websocket wrapper: "+r)},get_id_string:function(){return t.url}}}t.exports={connect:function(t){return function(e,r,n){return function(){return{connect:function(i,s,a,c){var u=new t(e,r,n);return u.onopen=c,o(u)}}}}},wrap:o}}).call(e,r(1).Buffer)},function(t,e,r){var n;(function(t,i){!function(o){function s(t){throw RangeError(I[t])}function a(t,e){for(var r=t.length,n=[];r--;)n[r]=e(t[r]);return n}function c(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(R,".");var i=t.split("."),o=a(i,e).join(".");return n+o}function u(t){for(var e,r,n=[],i=0,o=t.length;i<o;)e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<o?(r=t.charCodeAt(i++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--)):n.push(e);return n}function h(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=B(t>>>10&1023|55296),t=56320|1023&t),e+=B(t)}).join("")}function p(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:b}function l(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function f(t,e,r){var n=0;for(t=r?N(t/S):t>>1,t+=N(t/e);t>j*x>>1;n+=b)t=N(t/j);return N(n+(j+1)*t/(t+A))}function d(t){var e,r,n,i,o,a,c,u,l,d,_=[],m=t.length,y=0,v=O,g=k;for(r=t.lastIndexOf(P),r<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&s("not-basic"),_.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<m;){for(o=y,a=1,c=b;i>=m&&s("invalid-input"),u=p(t.charCodeAt(i++)),(u>=b||u>N((w-y)/a))&&s("overflow"),y+=u*a,l=c<=g?E:c>=g+x?x:c-g,!(u<l);c+=b)d=b-l,a>N(w/d)&&s("overflow"),a*=d;e=_.length+1,g=f(y-o,e,0==o),N(y/e)>w-v&&s("overflow"),v+=N(y/e),y%=e,_.splice(y++,0,v)}return h(_)}function _(t){var e,r,n,i,o,a,c,h,p,d,_,m,y,v,g,A=[];for(t=u(t),m=t.length,e=O,r=0,o=k,a=0;a<m;++a)_=t[a],_<128&&A.push(B(_));for(n=i=A.length,i&&A.push(P);n<m;){for(c=w,a=0;a<m;++a)_=t[a],_>=e&&_<c&&(c=_);for(y=n+1,c-e>N((w-r)/y)&&s("overflow"),r+=(c-e)*y,e=c,a=0;a<m;++a)if(_=t[a],_<e&&++r>w&&s("overflow"),_==e){for(h=r,p=b;d=p<=o?E:p>=o+x?x:p-o,!(h<d);p+=b)g=h-d,v=b-d,A.push(B(l(d+g%v,0))),h=N(g/v);A.push(B(l(h,0))),o=f(r,y,n==i),r=0,++n}++r,++e}return A.join("")}function m(t){return c(t,function(t){return T.test(t)?d(t.slice(4).toLowerCase()):t})}function y(t){return c(t,function(t){return U.test(t)?"xn--"+_(t):t})}var v=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof i&&i);v.global!==v&&v.window!==v&&v.self!==v||(o=v);var g,w=2147483647,b=36,E=1,x=26,A=38,S=700,k=72,O=128,P="-",T=/^xn--/,U=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=b-E,N=Math.floor,B=String.fromCharCode;g={version:"1.3.2",ucs2:{decode:u,encode:h},decode:d,encode:_,toASCII:y,toUnicode:m},n=function(){return g}.call(e,r,e,t),!(void 0!==n&&(t.exports=n))}(this)}).call(e,r(40)(t),function(){return this}())},function(t,e,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,r){if(t&&u.isObject(t)&&t instanceof n)return t;var i=new n;return i.parse(t,e,r),i}function o(t){return u.isString(t)&&(t=i(t)),t instanceof n?t.format():n.prototype.format.call(t)}function s(t,e){return i(t,!1,!0).resolve(e)}function a(t,e){return t?i(t,!1,!0).resolveObject(e):e}var c=r(35),u=r(37);e.parse=i,e.resolve=s,e.resolveObject=a,e.format=o,e.Url=n;var h=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,f=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(f),_=["'"].concat(d),m=["%","/","?",";","#"].concat(_),y=["/","?","#"],v=255,g=/^[+a-z0-9A-Z_-]{0,63}$/,w=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,b={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},x={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=r(26);n.prototype.parse=function(t,e,r){if(!u.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",o=t.split(i),s=/\\/g;o[0]=o[0].replace(s,"/"),t=o.join(i);var a=t;if(a=a.trim(),!r&&1===t.split("#").length){var p=l.exec(a);if(p)return this.path=a,this.href=a,this.pathname=p[1],p[2]?(this.search=p[2],e?this.query=A.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var f=h.exec(a);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,a=a.substr(f.length)}if(r||f||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===a.substr(0,2);!S||f&&E[f]||(a=a.substr(2),this.slashes=!0)}if(!E[f]&&(S||f&&!x[f])){for(var k=-1,O=0;O<y.length;O++){var P=a.indexOf(y[O]);P!==-1&&(k===-1||P<k)&&(k=P)}var T,U;U=k===-1?a.lastIndexOf("@"):a.lastIndexOf("@",k),U!==-1&&(T=a.slice(0,U),a=a.slice(U+1),this.auth=decodeURIComponent(T)),k=-1;for(var O=0;O<m.length;O++){var P=a.indexOf(m[O]);P!==-1&&(k===-1||P<k)&&(k=P)}k===-1&&(k=a.length),this.host=a.slice(0,k),a=a.slice(k),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var I=this.hostname.split(/\./),O=0,j=I.length;O<j;O++){var N=I[O];if(N&&!N.match(g)){for(var B="",M=0,L=N.length;M<L;M++)B+=N.charCodeAt(M)>127?"x":N[M];if(!B.match(g)){var C=I.slice(0,O),Y=I.slice(O+1),q=N.match(w);q&&(C.push(q[1]),Y.unshift(q[2])),Y.length&&(a="/"+Y.join(".")+a),this.hostname=C.join(".");break}}}this.hostname.length>v?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=c.toASCII(this.hostname));var z=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+z,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!b[d])for(var O=0,j=_.length;O<j;O++){var F=_[O];if(a.indexOf(F)!==-1){var W=encodeURIComponent(F);W===F&&(W=escape(F)),a=a.split(F).join(W)}}var J=a.indexOf("#");J!==-1&&(this.hash=a.substr(J),a=a.slice(0,J));var Q=a.indexOf("?");if(Q!==-1?(this.search=a.substr(Q),this.query=a.substr(Q+1),e&&(this.query=A.parse(this.query)),a=a.slice(0,Q)):e&&(this.search="",this.query={}),a&&(this.pathname=a),x[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",$=this.search||"";this.path=z+$;
}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u.isObject(this.query)&&Object.keys(this.query).length&&(o=A.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||x[e])&&i!==!1?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+i+r+s+n},n.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(u.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var r=new n,i=Object.keys(this),o=0;o<i.length;o++){var s=i[o];r[s]=this[s]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),c=0;c<a.length;c++){var h=a[c];"protocol"!==h&&(r[h]=t[h])}return x[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!x[t.protocol]){for(var p=Object.keys(t),l=0;l<p.length;l++){var f=p[l];r[f]=t[f]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||E[t.protocol])r.pathname=t.pathname;else{for(var d=(t.pathname||"").split("/");d.length&&!(t.host=d.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var _=r.pathname||"",m=r.search||"";r.path=_+m}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),g=v||y||r.host&&t.pathname,w=g,b=r.pathname&&r.pathname.split("/")||[],d=t.pathname&&t.pathname.split("/")||[],A=r.protocol&&!x[r.protocol];if(A&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===d[0]?d[0]=t.host:d.unshift(t.host)),t.host=null),g=g&&(""===d[0]||""===b[0])),v)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,b=d;else if(d.length)b||(b=[]),b.pop(),b=b.concat(d),r.search=t.search,r.query=t.query;else if(!u.isNullOrUndefined(t.search)){if(A){r.hostname=r.host=b.shift();var S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())}return r.search=t.search,r.query=t.query,u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var k=b.slice(-1)[0],O=(r.host||t.host||b.length>1)&&("."===k||".."===k)||""===k,P=0,T=b.length;T>=0;T--)k=b[T],"."===k?b.splice(T,1):".."===k?(b.splice(T,1),P++):P&&(b.splice(T,1),P--);if(!g&&!w)for(;P--;P)b.unshift("..");!g||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),O&&"/"!==b.join("/").substr(-1)&&b.push("");var U=""===b[0]||b[0]&&"/"===b[0].charAt(0);if(A){r.hostname=r.host=U?"":b.length?b.shift():"";var S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())}return g=g||r.host&&b.length,g&&!U&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),u.isNull(r.pathname)&&u.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var t=this.host,e=p.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(e,r){e.exports=t}])});